define("translations/quizzes.timing",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{ar:{quizzes:{timing:{labels:{time_elapsed:"انقضى الوقت",time_remaining:"الوقت المتبقي"}}}},es:{quizzes:{timing:{labels:{time_elapsed:"Tiempo Transcurrido",time_remaining:"Tiempo Restante"}}}},fr:{quizzes:{timing:{labels:{time_elapsed:"Temps écoulé",time_remaining:"Temps restant"}}}},ja:{quizzes:{timing:{labels:{time_elapsed:"経過時間",time_remaining:"残り時間"}}}},ko:{quizzes:{timing:{labels:{time_elapsed:"지난 시간",time_remaining:"남은 시간"}}}},nl:{quizzes:{timing:{labels:{time_elapsed:"Tijd verstreken",time_remaining:"Tijd resterend"}}}},pt:{quizzes:{timing:{labels:{time_elapsed:"Tempo transcorrido",time_remaining:"Tempo restante"}}}},ru:{quizzes:{timing:{labels:{time_elapsed:"Прошло времени",time_remaining:"Оставшееся время"}}}},zh:{quizzes:{timing:{labels:{time_elapsed:"经过时间",time_remaining:"剩余时间"}}}}}})}),define("quiz_timing",["i18n!quizzes.timing","jquery","vendor/date"],function(a,b){var c={initialTime:new Date,initTimes:function(){if(c.timesReady)return c.clientServerDiff;var a=Date.parse(b(".now").text())||c.initialTime||new Date,d=c.initialTime||new Date;c.clientServerDiff=a.getTime()-d.getTime(),c.timesReady=!0},setReferenceDate:function(d,e,f){c.timesReady||c.initTimes();var g={};return g.referenceDate=Date.parse(e),g.isDeadline=!0,b(".time_header").text(a.beforeLabel("time_remaining","Time Remaining")),g.referenceDate||(g.isDeadline=!1,b(".time_header").text(a.beforeLabel("time_elapsed","Time Elapsed")),g.referenceDate=Date.parse(d)),g.clientServerDiff=c.clientServerDiff,g}};return c}),define("translations/quizzes.moderate",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{ar:{quizzes:{moderate:{buttons:{extend_time:"تمديد الوقت",extending_time:"جارٍ تمديد الوقت...",save:"حفظ",save_failed:"فشل الحفظ، الرجاء المحاولة مرة أخرى",save_failed_n_updates_lost:"فشل الحفظ, لم يتم تحديث %{n} طالبًا (طلاب)",saving:"جارٍ الحفظ...",time_extension_failed:"فشل تمديد الوقت، الرجاء المحاولة مرة أخرى"},confirms:{taking_time_away:"سيكون هذا وقتًا أقل من المتاح حاليًا لدى الطالب  هل تريد المتابعة على أية حال؟"},errors:{server_communication_failed:"حدثت مشكلة أثناء الاتصال بالخادم.  سيحاول النظام الاتصال خلال خمس دقائق، أو يمكنك إعادة تحميل الصفحة"},extensions_for_student:"امتدادات لـ %{student}",extensions_for_students:{one:"الامتدادات لطالب واحد",other:"الامتدادات لـ %{count} من الطلاب"},finished_in_duration:"تم الانتهاء في %{duration}",time_up:"انتهى الوقت!",titles:{extend_quiz_time:"تمديد وقت الاختبار",student_extensions:"تمديدات للطالب"}}}},es:{quizzes:{moderate:{buttons:{extend_time:"Extender el Tiempo",extending_time:"Extendiendo el Tiempo...",save:"Guardar",save_failed:"No se pudo Guardar, intente de nuevo",save_failed_n_updates_lost:"No se pudo guardar, %{n} estudiantes no se actualizaron",saving:"Guardando...",time_extension_failed:"No se pudo Extender el Tiempo, intente de nuevo"},confirms:{taking_time_away:"Eso sería menos tiempo del que el estudiante tiene actualmente. ¿Continuar?"},errors:{server_communication_failed:"Ocurrió un problema al comunicarse con el servidor. El sistema intentará de nuevo en cinco minutos, o puede recargar la página"},extensions_for_student:"Extensiones para %{student}",extensions_for_students:{one:"Extensiones para 1 estudiante",other:"Extensiones para %{count} estudiantes"},finished_in_duration:"terminó en %{duration}",time_up:"¡Se ha acabado el Tiempo!",titles:{extend_quiz_time:"Extender el Tiempo de la Evaluación",student_extensions:"Extensiones de Estudiantes"}}}},fr:{quizzes:{moderate:{buttons:{extend_time:"Prolonger la durée",extending_time:"Prolongation de la durée...",save:"Enregistrer",save_failed:"Échec de l’enregistrement, veuillez réessayer",save_failed_n_updates_lost:"Échec de l’enregistrement, %{n} étudiants n’ont pas été mis à jour.",saving:"Enregistrement...",time_extension_failed:"La prolongation a échoué, veuillez réessayer"},confirms:{taking_time_away:"L’étudiant disposera de moins de temps qu’il n’a actuellement. Voulez-vous continuer ?"},errors:{server_communication_failed:"Un problème de communication s’est produit avec le serveur. Le système fera une nouvelle tentative dans 5 minutes, ou vous pouvez retélécharger la page."},extensions_for_student:"Prolongation pour %{student}",extensions_for_students:{one:"Prolongation pour 1 étudiant",other:"Prolongation pour %{count} étudiants"},finished_in_duration:"interruption dans %{duration}",time_up:"Terminé !",titles:{extend_quiz_time:"Prolonger la durée du questionnaire",student_extensions:"Prolongations pour l’étudiant"}}}},ja:{quizzes:{moderate:{buttons:{extend_time:"時間の延長",extending_time:"時間を延長しています...",save:"保存",save_failed:"保存に失敗しました。もう一度やり直してください",save_failed_n_updates_lost:"保存に失敗しました。%{n} 名の受講生が更新されませんでした",saving:"保存しています...",time_extension_failed:"時間延長に失敗しました。もう一度やり直してください"},confirms:{taking_time_away:"その設定では、受講生の現在の持ち時間より少なくなってしまいます。続行しますか?"},errors:{server_communication_failed:"サーバとの通信で問題が発生しました。5 分後に再試行されます。またはページを再読み込みしてください"},extensions_for_student:"%{student} に対する延長時間",extensions_for_students:{one:"%{count} 人の受講生に対する延長",other:"%{count} 人の受講生に対する延長"},finished_in_duration:"%{duration} で完了しました",time_up:"制限時間になりました!",titles:{extend_quiz_time:"クイズの時間延長",student_extensions:"受講生の延長時間"}}}},ko:{quizzes:{moderate:{buttons:{extend_time:"시간 연장",extending_time:"시간 연장 중...",save:"저장",save_failed:"저장에 실패했습니다. 다시 시도하시기 바랍니다.",save_failed_n_updates_lost:"저장에 실패했습니다. 학생 %{n}명은 업데이트되지 않았습니다.",saving:"저장 중...",time_extension_failed:"시간 연장에 실패했습니다. 다시 시도하시기 바랍니다."},confirms:{taking_time_away:"학생이 지금 가지고 있는 시간보다 줄어들게 됩니다. 계속 진행하시겠습니까?"},errors:{server_communication_failed:"서버와 통신하는 데 문제가 있습니다. 시스템이 5분 내에 다시 시도하거나 여러분이 페이지를 다시 로드할 수 있습니다."},extensions_for_student:"%{student}에 대한 연장",extensions_for_students:{one:"학생 %{count}명에 대한 연장",other:"학생 %{count}명에 대한 연장"},finished_in_duration:"%{duration} 안에 마침",time_up:"시간 종료!",titles:{extend_quiz_time:"퀴즈 시간 연장",student_extensions:"학생 연장"}}}},nl:{quizzes:{moderate:{buttons:{extend_time:"Tijd verlengen",extending_time:"Bezig met verlengen van tijd...",save:"Opslaan",save_failed:"Opslaan mislukt, probeer het opnieuw",save_failed_n_updates_lost:"Opslaan mislukt, %{n} leerlingen zijn niet gewijzigd",saving:"Bezig met opslaan...",time_extension_failed:"Verlengen van de tijd is mislukt, probeer het opnieuw"},confirms:{taking_time_away:"Dat zou minder tijd zijn als dat de leerling nu heeft. Toch doorgaan?"},errors:{server_communication_failed:"Er is een probleem opgetreden tijdens het communiceren met de server. Het systeem probeert het opnieuw in vijf minuten, of herlaad deze pagina"},extensions_for_student:"Verlengingen voor %{student}",extensions_for_students:{one:"Verlenging voor 1 leerling",other:"Verlenging voor %{count} leerlingen"},finished_in_duration:"afgerond in %{duration}",time_up:"Tijd is afgelopen!",titles:{extend_quiz_time:"Verleng testtijd",student_extensions:"Tijdsverlening voor leerling"}}}},pt:{quizzes:{moderate:{buttons:{extend_time:"Estender tempo",extending_time:"Estendendo tempo...",save:"Guardar",save_failed:"Falha ao guardar, tente novamente",save_failed_n_updates_lost:"Falha ao guardar, %{n} alunos não foram atualizados",saving:"A guardar...",time_extension_failed:"Falha ao estender tempo, tente novamente"},confirms:{taking_time_away:"Isso seria menos tempo do que aquele que o aluno tem de momento.  Continuar mesmo assim?"},errors:{server_communication_failed:"Houve um problema na comunicação com o servidor.  O sistema tentará novamente em cinco minutos ou pode recarregar a página"},extensions_for_student:"Extensões para %{student}",extensions_for_students:{one:"Extensões para 1 aluno",other:"Extensões para %{count} aluno"},finished_in_duration:"finalizado em %{duration}",time_up:"Acabou o tempo!",titles:{extend_quiz_time:"Estender o tempo do teste",student_extensions:"Extensões do aluno"}}}},ru:{quizzes:{moderate:{buttons:{extend_time:"Добавить время",extending_time:"Добавление времени...",save:"Сохранить",save_failed:"Ошибка сохранения, повторите попытку",save_failed_n_updates_lost:"Ошибка сохранения, %{n} студентов не были обновлены",saving:"Сохранение...",time_extension_failed:"Ошибка добавления времени, повторите попытку"},confirms:{taking_time_away:"Это будет меньшим временем, чем сейчас имеется у студента.  Продолжить?"},errors:{server_communication_failed:"Произошел сбой связи с сервером.  Система повторит попытку через пять минут, или можно перезагрузить страницу"},extensions_for_student:"Расширения для %{student}",extensions_for_students:{one:"Расширения для 1 студента",other:"Расширения для %{count} студентов"},finished_in_duration:"завершено в %{duration}",time_up:"Время истекло!",titles:{extend_quiz_time:"Увеличить время на контрольную работу",student_extensions:"Расширения студента"}}}},zh:{quizzes:{moderate:{buttons:{extend_time:"延长时间",extending_time:"正在延长时间...",save:"保存",save_failed:"保存失败，请重试",save_failed_n_updates_lost:"保存失败，%{n} 名学生没有更新",saving:"正在保存...",time_extension_failed:"延长时间失败，请重试"},confirms:{taking_time_away:"这将比学生当前拥有的时间少。是否仍要继续?"},errors:{server_communication_failed:"与服务器通信时出现问题。系统将在五分钟内重试，或者您可以重新加载该页面"},extensions_for_student:"%{student} 的延时",extensions_for_students:{one:"%{count} 个学生的延时",other:"%{count} 个学生的延时"},finished_in_duration:"在 %{duration} 内完成",time_up:"时间到！",titles:{extend_quiz_time:"延长测验时间",student_extensions:"学生延时"}}}}}})}),define("moderate_quiz",["i18n!quizzes.moderate","jquery","quiz_timing","jquery.ajaxJSON","jquery.instructure_date_and_time","jquery.instructure_forms","jqueryui/dialog","compiled/jquery/fixDialogButtons","jquery.instructure_misc_helpers","jquery.instructure_misc_plugins","compiled/jquery.rails_flash_notifications","jquery.templateData","vendor/date"],function(a,b,c){window.moderation={updateTimes:function(){var d=new Date;moderation.studentsCurrentlyTakingQuiz=!!b("#students .student.in_progress"),b("#students .student.in_progress").each(function(){var e=b(this),f=e.data("timing")||{},g=e.attr("data-started-at"),h=e.attr("data-end-at");f.referenceDate||b.extend(f,c.setReferenceDate(g,h,d));if(!f.referenceDate)return;e.data("timing",f);var i=f.referenceDate.getTime()-d.getTime()-f.clientServerDiff;if(f.isDeadline&&i<0){e.find(".time").text(a.t("time_up","Time Up!"));return}e.data("minutes_left",i/6e4);var j=new Date(Math.abs(i)),k=j.getUTCFullYear()-1970,l=j.getUTCMonth();l+=12*k;var m=j.getUTCDate()-1,n=j.getUTCHours(),o=j.getUTCMinutes(),p=j.getUTCSeconds(),q=[];l&&q.push(l<10?"0"+l:l),m&&q.push(m<10?"0"+m:m),n&&q.push(n<10?"0"+n:n),q.push(o<10?"0"+o:o),q.push(p<10?"0"+p:p),e.find(".time").text(q.join(":"))})},updateSubmission:function(c,d){var e=b("#student_"+c.user_id);d&&(moderation.lastUpdatedAt=new Date(Math.max(Date.parse(c.updated_at),moderation.lastUpdatedAt)));var f="";if(c.workflow_state=="complete"||c.workflow_state=="pending_review")f=a.t("finished_in_duration","finished in %{duration}",{duration:c.finished_in_words});var g={attempt:c.attempt||"--",extra_time:c.extra_time,extra_attempts:c.extra_attempts,score:c.kept_score};c.attempts_left==-1?g.attempts_left="--":c.attempts_left&&(g.attempts_left=c.attempts_left),c.workflow_state!="untaken"&&(g.time=f),e.fillTemplateData({data:g}).toggleClass("extendable",c["extendable?"]).toggleClass("in_progress",c.workflow_state=="untaken").toggleClass("manually_unlocked",!!c.manually_unlocked).attr("data-started-at",c.started_at||"").attr("data-end-at",c.end_at||"").data("timing",null).find(".extra_time_allowed").showIf(c.extra_time).end().find(".unlocked").showIf(c.manually_unlocked)},lastUpdatedAt:"",studentsCurrentlyTakingQuiz:!1},b(document).ready(function(d){function i(a){g=a,a?h.attr("src",h.attr("src").replace("ajax-reload.gif","ajax-reload-animated.gif")):h.attr("src",h.attr("src").replace("ajax-reload-animated.gif","ajax-reload.gif"))}function j(c){if(g)return;i(!0);var d=moderation.lastUpdatedAt&&moderation.lastUpdatedAt.toISOString();b.ajaxJSON(b.replaceTags(f,"update",d),"GET",{},function(a){i(!1),c&&(a.length||moderation.studentsCurrentlyTakingQuiz?setTimeout(function(){j(!0)},6e4):setTimeout(function(){j(!0)},18e4));for(var b in a)moderation.updateSubmission(a[b],!0)},function(d){i(!1),e++,e>5?(b.flashMessage(a.t("errors.server_communication_failed","There was a problem communicating with the server.  The system will try again in five minutes, or you can reload the page")),e=0,c&&setTimeout(function(){j(!0)},3e5)):c&&setTimeout(function(){j(!0)},12e4)})}function k(){var a=b(".student_check:checked").length;b("#checked_count").text(a),b(".moderate_multiple_button").showIf(a)}c.initTimes(),setInterval(moderation.updateTimes,500);var e=0,f=b(".update_url").attr("href");moderation.lastUpdatedAt=Date.parse(b(".last_updated_at").text());var g=!1,h=b(".reload_link img");setTimeout(function(){j(!0)},1e3),b("#check_all").change(function(){b(".student_check").attr("checked",b(this).attr("checked")),k()}),b(".student_check").change(function(){b(this).attr("checked")||b("#check_all").attr("checked",!1),k()}),b(".moderate_multiple_button").live("click",function(c){var d=[],e={};b(".student_check:checked").each(function(){var a=b(this).parents(".student");d.push(b(this).attr("data-id"));var c={manually_unlocked:a.hasClass("manually_unlocked")?"1":"0",extra_attempts:parseInt(a.find(".extra_attempts").text(),10)||"",extra_time:parseInt(a.find(".extra_time").text(),10)||""};b.each(["manually_unlocked","extra_attempts","extra_time"],function(){e[this]==null?e[this]=c[this].toString():e[this]!=c[this].toString()&&(e[this]="")})}),b("#moderate_student_form").data("ids",d),b("#moderate_student_dialog h2").text(a.t("extensions_for_students",{one:"Extensions for 1 Student",other:"Extensions for %{count} Students"},{count:d.length})),b("#moderate_student_form").fillFormData(e),b("#moderate_student_dialog").dialog({title:a.t("titles.student_extensions","Student Extensions"),width:400}).fixDialogButtons()}),b(".moderate_student_link").live("click",function(c){c.preventDefault();var d=b(this).parents(".student"),e={manually_unlocked:d.hasClass("manually_unlocked")?"1":"0",extra_attempts:parseInt(d.find(".extra_attempts").text(),10)||"",extra_time:parseInt(d.find(".extra_time").text(),10)||""},f=d.find(".student_name").text();b("#moderate_student_form").fillFormData(e),b("#moderate_student_form").data("ids",[d.attr("data-user-id")]),b("#moderate_student_form").find("button").attr("disabled",!1),b("#moderate_student_dialog h2").text(a.t("extensions_for_student","Extensions for %{student}",{student:f})),b("#moderate_student_dialog").dialog({title:a.t("titles.student_extensions","Student Extensions"),width:400}).fixDialogButtons()}),b(".reload_link").click(function(a){a.preventDefault(),j()}),b("#moderate_student_form").submit(function(c){function i(){f>=d.length&&(g>0?d.length==1?e.find("button").attr("disabled",!1).filter(".save_button").text(a.t("buttons.save_failed","Save Failed, please try again")):e.find("button").attr("disabled",!1).filter(".save_button").text(a.t("buttons.save_failed_n_updates_lost","Save Failed, %{n} Students were not updated",{n:g})):(e.find("button").attr("disabled",!1).filter(".save_button").text(a.t("buttons.save","Save")),b("#moderate_student_dialog").dialog("close")))}c.preventDefault(),c.stopPropagation();var d=b(this).data("ids");if(d.length==0)return;var e=b(this);e.find("button").attr("disabled",!0).filter(".save_button").text(a.t("buttons.saving","Saving..."));var f=0,g=0,h=b(this).getFormData();for(var j in d){var k=d[j],l=b.replaceTags(b(".extension_url").attr("href"),"user_id",k);b.ajaxJSON(l,"POST",h,function(a){f++,moderation.updateSubmission(a),i()},function(a){f++,g++,i()})}}),b("#moderate_student_dialog").find(".cancel_button").click(function(){b("#moderate_student_dialog").dialog("close")}),b(".extend_time_link").live("click",function(c){c.preventDefault();var d=b(c.target).parents(".student"),e=b.parseFromISO(d.attr("data-end-at")).datetime_formatted,f=b.parseFromISO(d.attr("data-started-at")).datetime_formatted,g=b("#extend_time_dialog");g.data("row",d),g.fillTemplateData({data:{end_at:e,started_at:f}}),g.find("button").attr("disabled",!1),g.dialog({title:a.t("titles.extend_quiz_time","Extend Quiz Time"),width:400}).fixDialogButtons()}),b("#extend_time_dialog").find(".cancel_button").click(function(){b("#extend_time_dialog").dialog("close")}).end().find(".save_button").click(function(){var c=b("#extend_time_dialog"),d=c.getFormData(),e={};d.time=parseInt(d.time,10)||0;if(d.time<=0)return;if(d.time_type=="extend_from_now"&&d.time<c.data("row").data("minutes_left")){var f=confirm(a.t("confirms.taking_time_away","That would be less time than the student currently has.  Continue anyway?"));if(!f)return}e[d.time_type]=d.time,c.find("button").attr("disabled",!0).filter(".save_button").text(a.t("buttons.extending_time","Extending Time..."));var g=b.replaceTags(b(".extension_url").attr("href"),"user_id",c.data("row").attr("data-user-id"));b.ajaxJSON(g,"POST",e,function(b){c.find("button").attr("disabled",!1).filter(".save_button").text(a.t("buttons.extend_time","Extend Time")),moderation.updateSubmission(b),c.dialog("close")},function(b){c.find("button").attr("disabled",!1).filter(".save_button").text(a.t("buttons.time_extension_failed","Extend Time Failed, please try again"))})})})}),function(){require(["quiz_timing","moderate_quiz"])}.call(this),define("compiled/bundles/moderate_quiz",function(){})