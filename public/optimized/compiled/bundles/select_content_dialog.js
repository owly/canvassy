define("translations/select_content_dialog",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{ar:{select_content_dialog:{buttons:{add_item:"إضافة عنصر"},errors:{external_tool_url:"لا يمكن حفظ إحدى الأدوات الخارجية بدون أحد عناوين URL.",failed_to_create_item:"فشل إنشاء عنصر جديد",loading_failed:"فشل التحميل"},invalid_lti_resource_selection:"توجد مشكلة أثناء استرداد ارتباط صالح من الأداة الخارجية",link_from_external_tool:"ربط المورد من الأداة الخارجية",titles:{add_item_to_module:"إضافة العنصر إلى الوحدة",find_links_using_service:"بحث عن ارتبطات باستخدام %{service}"}}},es:{select_content_dialog:{buttons:{add_item:"Agregar Elemento"},errors:{external_tool_url:"No se puede guardar una herramienta externa sin una URL.",failed_to_create_item:"No se pudo crear un elemento nuevo",loading_failed:"No se pudo cargar"},invalid_lti_resource_selection:"Ha habido un problema al recuperar un enlace válido de una herramienta externa",link_from_external_tool:"Recurso de enlace de una herramienta externa",titles:{add_item_to_module:"Agregar Elemento al Módulo",find_links_using_service:"Encontrar enlaces usando %{service}"}}},fr:{select_content_dialog:{buttons:{add_item:"Ajouter un élément"},errors:{external_tool_url:"Impossible d’enregistrer un outil externe sans URL.",failed_to_create_item:"Échec de création d’un élément",loading_failed:"Échec du chargement"},invalid_lti_resource_selection:"Un problème s’est produit pendant la récupération d’un lien valide de l’outil externe.",link_from_external_tool:"Source de lien de l’outil externe",titles:{add_item_to_module:"Ajouter un élément au module",find_links_using_service:"Chercher des liens à l’aide de %{service}"}}},ja:{select_content_dialog:{buttons:{add_item:"アイテムの追加"},errors:{external_tool_url:"URL を指定しないと、外部ツールを保存できません。",failed_to_create_item:"新しいアイテムの作成に失敗しました",loading_failed:"読み込みに失敗しました"},invalid_lti_resource_selection:"外部ツールから有効なリンクを取得する際に問題が発生しました",link_from_external_tool:"外部ツールからリソースをリンク",titles:{add_item_to_module:"モジュールにアイテムを追加",find_links_using_service:"%{service} を使用してリンクを検索"}}},ko:{select_content_dialog:{buttons:{add_item:"항목 추가"},errors:{external_tool_url:"외부 도구는 URL이 없이 저장할 수 없습니다.",failed_to_create_item:"새 항목 만들기 실패",loading_failed:"로드 실패"},invalid_lti_resource_selection:"외부 도구에서 유효한 링크를 찾아오는 데 문제가 발생했습니다.",link_from_external_tool:"외부 도구에서 리소스 링크",titles:{add_item_to_module:"모듈에 항목 추가",find_links_using_service:"%{service}을(를) 이용해서 링크 찾기"}}},nl:{select_content_dialog:{buttons:{add_item:"Voeg item toe"},errors:{external_tool_url:"Een extern hulpmiddel kan niet zonder URL worden opgeslagen",failed_to_create_item:"Kan het nieuwe item niet maken",loading_failed:"Laden mislukt"},invalid_lti_resource_selection:"Er is een probleem opgetreden bij het ontvangen van de juiste link van het externe hulpmiddel",link_from_external_tool:"Koppel bron van extern hulpmiddel",titles:{add_item_to_module:"Item aan module toevoegen",find_links_using_service:"Koppelingen zoeken met %{service}"}}},pt:{select_content_dialog:{buttons:{add_item:"Adicionar item"},errors:{external_tool_url:"Não é possível guardar uma ferramenta externa sem um URL",failed_to_create_item:"Falha ao criar novo item",loading_failed:"Falha no carregamento"},invalid_lti_resource_selection:"Houve um problema ao recuperar um link válido de uma ferramenta externa",link_from_external_tool:"Associar recurso de ferramenta externa",titles:{add_item_to_module:"Adicionar item ao módulo",find_links_using_service:"Localizar link usando %{service}"}}},ru:{select_content_dialog:{buttons:{add_item:"Добавить элемент"},errors:{external_tool_url:"Внешний инструмент не может быть сохранен без URL-адреса.",failed_to_create_item:"Ошибка создания нового элемента",loading_failed:"Ошибка загрузки"},invalid_lti_resource_selection:"Ошибка получения действительной ссылки из внешнего инструмента",link_from_external_tool:"Ссылка на ресурс из внешнего инструмента",titles:{add_item_to_module:"Добавить элемент в модуль",find_links_using_service:"Поиск ссылок с помощью %{service}"}}},zh:{select_content_dialog:{buttons:{add_item:"添加项目"},errors:{external_tool_url:"没有 URL，无法保存外部工具。",failed_to_create_item:"无法创建新项目",loading_failed:"加载失败"},invalid_lti_resource_selection:"从外部工具检索有效链接时出现问题",link_from_external_tool:"从外部工具链接资源",titles:{add_item_to_module:"添加项目到单元",find_links_using_service:"使用 %{service} 查找链接"}}}}})}),define("select_content_dialog",["INST","i18n!select_content_dialog","jquery","jquery.ajaxJSON","jquery.instructure_forms","jqueryui/dialog","compiled/jquery/fixDialogButtons","jquery.instructure_misc_helpers","jquery.instructure_misc_plugins","jquery.keycodes","jquery.loadingImg","jquery.templateData"],function(a,b,c){c(document).ready(function(){var d=null,e=c("#select_context_content_dialog");attachAddAssignment(c("#assignments_select .module_item_select")),a=a||{},a.selectContentDialog=function(a){var f=a.for_modules,g=a.select_button_text||b.t("buttons.add_item","Add Item"),h=a.holder_name||"module",i=a.dialog_title||b.t("titles.add_item_to_module","Add Item to Module"),j=f;e.data("submitted_function",a.submit),e.find(".context_module_content").showIf(f),e.find(".holder_name").text(h),e.find(".add_item_button").text(g),e.find(".select_item_name").showIf(!a.no_name_input);if(j&&!d){var k=c("#content_tag_services").empty();c.getUserServices("BookmarkService",function(a){for(var d in a){service=a[d].user_service,$service=c("<a href='#' class='bookmark_service no-hover'/>"),$service.addClass(service.service),$service.data("service",service),$service.attr("title",b.t("titles.find_links_using_service","Find links using %{service}",{service:service.service}));var e=c("<img/>");e.attr("src","/images/"+service.service+"_small_icon.png"),$service.append(e),$service.click(function(a){a.preventDefault(),c.findLinkForService(c(this).data("service").service,function(a){c("#content_tag_create_url").val(a.url),c("#content_tag_create_title").val(a.title)})}),k.append($service),k.append("&nbsp;&nbsp;")}})}c("#select_context_content_dialog #external_urls_select :text").val(""),c("#select_context_content_dialog #context_module_sub_headers_select :text").val(""),c("#add_module_item_select").change(),c("#select_context_content_dialog .module_item_select").change(),c("#select_context_content_dialog").dialog({title:i,width:400}).fixDialogButtons(),c("#select_context_content_dialog").dialog("option","title",i)},c("#select_context_content_dialog .cancel_button").click(function(){e.find(".alert").remove(),e.dialog("close")}),c("#select_context_content_dialog .item_title").keycodes("return",function(){c(this).parents(".module_item_option").find(".add_item_button").click()}),c("#select_context_content_dialog .add_item_button").click(function(){var a=function(a){e.dialog("close"),e.find(".alert").remove();var b=e.data("submitted_function");b&&c.isFunction(b)&&b(a)},d=c("#add_module_item_select").val();if(d=="external_url"){var f={"item[type]":c("#add_module_item_select").val(),"item[id]":c("#select_context_content_dialog .module_item_option:visible:first .module_item_select").val(),"item[indent]":c("#content_tag_indent").val()};f["item[url]"]=c("#content_tag_create_url").val(),f["item[title]"]=c("#content_tag_create_title").val(),a(f)}else if(d=="context_external_tool"){var f={"item[type]":c("#add_module_item_select").val(),"item[id]":c("#context_external_tools_select .tools .tool.selected").data("id"),"item[new_tab]":c("#external_tool_create_new_tab").attr("checked")?"1":"0","item[indent]":c("#content_tag_indent").val()};f["item[url]"]=c("#external_tool_create_url").val(),f["item[title]"]=c("#external_tool_create_title").val(),e.find(".alert-error").remove();if(f["item[url]"]===""){var g=c("<div />",{"class":"alert alert-error",role:"alert"}).css({marginTop:8});g.text(b.t("errors.external_tool_url","An external tool can't be saved without a URL.")),e.prepend(g)}else a(f)}else if(d=="context_module_sub_header"){var f={"item[type]":c("#add_module_item_select").val(),"item[id]":c("#select_context_content_dialog .module_item_option:visible:first .module_item_select").val(),"item[indent]":c("#content_tag_indent").val()};f["item[title]"]=c("#sub_header_title").val(),a(f)}else{var h=c("#select_context_content_dialog .module_item_option:visible:first .module_item_select option:selected");h.each(function(){var e=c(this),f={"item[type]":d,"item[id]":e.val(),"item[title]":e.text(),"item[indent]":c("#content_tag_indent").val()};if(f["item[id]"]=="new"){c("#select_context_content_dialog").loadingImage();var g=c("#select_context_content_dialog .module_item_option:visible:first .new .add_item_url").attr("href"),h=c("#select_context_content_dialog .module_item_option:visible:first").getFormData(),i=function(b){var d;f["item[type]"]==="discussion_topic"?d=b:d=b[f["item[type]"]],c("#select_context_content_dialog").loadingImage("remove"),f["item[id]"]=d.id,f["item[title]"]=c("#select_context_content_dialog .module_item_option:visible:first .item_title").val(),f["item[title]"]=f["item[title]"]||d.display_name;var e=c(document.createElement("option"));e.val(d.id).text(f["item[title]"]),c("#"+f["item[type]"]+"s_select").find(".module_item_select option:last").before(e),a(f)};f["item[type]"]=="attachment"?c.ajaxJSONFiles(g,"POST",h,c("#module_attachment_uploaded_data"),function(a){i(a)},function(a){c("#select_context_content_dialog").loadingImage("remove"),c("#select_context_content_dialog").errorBox(b.t("errors.failed_to_create_item","Failed to Create new Item"))}):c.ajaxJSON(g,"POST",h,function(a){i(a)},function(a){c("#select_context_content_dialog").loadingImage("remove"),c("#select_context_content_dialog").errorBox(b.t("errors.failed_to_create_item","Failed to Create new Item"))})}else a(f)})}}),c("#context_external_tools_select .tools").delegate(".tool","click",function(){var a=c(this);if(c(this).hasClass("selected")&&!c(this).hasClass("resource_selection")){c(this).removeClass("selected");return}a.parents(".tools").find(".tool.selected").removeClass("selected"),a.addClass("selected");if(a.hasClass("resource_selection")){var d=a.data("tool"),e=Math.max(Math.min(c(window).height()-100,550),100),f=d.resource_selection.selection_width||d.selection_width,g=d.resource_selection.selection_height||d.selection_height,h=c("#resource_selection_dialog");h.length==0&&(h=c("<div/>",{id:"resource_selection_dialog",style:"padding: 0; overflow-y: hidden;"}),h.append(c("<iframe/>",{id:"resource_selection_iframe",style:"width: 800px; height: "+e+"px; border: 0;",src:"/images/ajax-loader-medium-444.gif",borderstyle:"0"})),c("body").append(h.hide()),h.dialog({autoOpen:!1,width:"auto",resizable:!0,close:function(){h.find("iframe").attr("src","/images/ajax-loader-medium-444.gif")},title:b.t("link_from_external_tool","Link Resource from External Tool")}).bind("dialogresize",function(){c(this).find("iframe").add(".fix_for_resizing_over_iframe").height(c(this).height()).width(c(this).width())}).bind("dialogresizestop",function(){c(".fix_for_resizing_over_iframe").remove()}).bind("dialogresizestart",function(){c(this).find("iframe").each(function(){c('<div class="fix_for_resizing_over_iframe" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e7}).css(c(this).offset()).appendTo("body")})}).bind("selection",function(a,e){e.return_type=="lti_launch_url"&&e.url?(c("#external_tool_create_url").val(e.url),c("#external_tool_create_title").val(e.text||d.name),c("#context_external_tools_select .domain_message").hide()):(alert(b.t("invalid_lti_resource_selection","There was a problem retrieving a valid link from the external tool")),c("#external_tool_create_url").val(""),c("#external_tool_create_title").val("")),c("#resource_selection_dialog iframe").attr("src","about:blank"),c("#resource_selection_dialog").dialog("close")})),h.dialog("close").dialog("option","width",f||800).dialog("option","height",g||e||400).dialog("open"),h.triggerHandler("dialogresize");var i=c.replaceTags(c("#select_content_resource_selection_url").attr("href"),"id",d.id);h.find("iframe").attr("src",i)}else c("#external_tool_create_url").val(a.data("url")||""),c("#context_external_tools_select .domain_message").showIf(a.data("domain")).find(".domain").text(a.data("domain")),c("#external_tool_create_title").val(a.data("name"))});var f=c("#context_external_tools_select .tools .tool:first").detach();c("#add_module_item_select").change(function(){c("#select_context_content_dialog .module_item_option").hide(),c("#"+c(this).val()+"s_select").show().find(".module_item_select").change();if(c(this).val()=="context_external_tool"){var a=c("#context_external_tools_select");if(!a.hasClass("loaded")){a.find(".message").text("Loading...");var d=c("#select_context_content_dialog .external_tools_url").attr("href");c.ajaxJSON(d,"GET",{},function(b){a.find(".message").remove(),a.addClass("loaded"),a.find(".tools").empty();for(var c in b){var d=b[c];if(d.url||d.domain||d.resource_selection){var e=f.clone(!0);e.toggleClass("resource_selection",!!d.resource_selection),e.fillTemplateData({data:d,dataValues:["id","url","domain","name"]}),e.data("tool",d),a.find(".tools").append(e.show())}}},function(c){a.find(".message").text(b.t("errors.loading_failed","Loading Failed"))})}}}),c("#select_context_content_dialog .module_item_select").change(function(){c(this).val()=="new"?c(this).parents(".module_item_option").find(".new").show().focus().select():c(this).parents(".module_item_option").find(".new").hide()})})}),function(){require(["select_content_dialog"])}.call(this),define("compiled/bundles/select_content_dialog",function(){})