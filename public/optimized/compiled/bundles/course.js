define("translations/courses",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{ar:{courses:{confirm_reject_invitation:"هل ترغب بالتأكيد في رفض الدعوة للمشاركة في هذا المساق؟"}},es:{courses:{confirm_reject_invitation:"Está seguro que quiere rechazar la invitación a participar en este curso?"}},fr:{courses:{confirm_reject_invitation:"Voulez-vous vraiment rejeter l’invitation à participer au cours ?"}},ja:{courses:{confirm_reject_invitation:"このコースへの参加についての招待を拒否してもよろしいですか?"}},ko:{courses:{confirm_reject_invitation:"이 과목 참여 초대를 거절하시겠습니까?"}},nl:{courses:{confirm_reject_invitation:"Weet je zeker dat je de uitnodiging om deel te nemen aan deze cursus wil negeren?"}},pt:{courses:{confirm_reject_invitation:"Tem a certeza de que pretende rejeitar o convite para participar nesta disciplina?"}},ru:{courses:{confirm_reject_invitation:"Отклонить приглашение на участие в курсе?"}},zh:{courses:{confirm_reject_invitation:"是否确定要拒绝参加此课程的邀请?"}}}})}),define("course",["i18n!courses","jquery"],function(a,b){b(document).ready(function(){b(".reject_button").click(function(b){var c=confirm(a.t("confirm_reject_invitation","Are you sure you want to reject the invitation to participate in this course?"));c||(b.preventDefault(),b.stopPropagation())})})}),define("translations/context_modules",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{ar:{context_modules:{buttons:{add:"إضافة وحدة",add_item:"إضافة عنصر",update:"تحديث الوحدة"},confirm:{"delete":"هل ترغب بالتأكيد في حذف هذه الوحدة؟",delete_item:"هل ترغب بالتأكيد في إزالة هذا العنصر من الوحدة؟"},context_module:{unpublish:"عدم النشر"},context_modules:{publish:"نشر"},errors:{reorder:"فشل إعادة الترتيب، الرجاء المحاولة مرة أخرى."},none_in_progress:"لا يوجد شيء قيد التقدم",optgroup:{assignments:"المهام",discussion_topics:"المناقشات",external_tools:"الأدوات الخارجية",external_urls:"عناوين URL الخارجية",files:"الملفات",quizzes:"الاختبارات",wiki_pages:"صفحات Wiki"},points_possible_short:"%{points} نقاط",still_needs_completing:"ما زال يحتاج إلى احجبال",titles:{add:"إضافة وحدة",add_item:"إضافة عنصر إلى %{module}",add_prerequisite:"إضافة متطلب ضروري إلى %{module}",edit:"تحرير إعدادات الوحدة",edit_item:"تحرير تفاصيل العنصر",student_progress:"تقدم الطلاب في الوحدة"}}},es:{context_modules:{buttons:{add:"Agregar Módulo",add_item:"Agregar Elemento",update:"Actualizar Módulo"},confirm:{"delete":"¿Seguro que quiere borrar este módulo?",delete_item:"¿Seguro que quiere remover este elemento del módulo?"},context_module:{unpublish:"No publicar"},context_modules:{publish:"Publicar"},errors:{reorder:"Falló la reorganización, intente de nuevo."},none_in_progress:"nada en progreso",optgroup:{assignments:"Tareas",discussion_topics:"Discusiones",external_tools:"Herramientas Externas",external_urls:"URLs Externos",files:"Archivos",quizzes:"Evaluaciones",wiki_pages:"Páginas Wiki"},points_possible_short:"%{points} pts",still_needs_completing:"Todavía necesita ser completado",titles:{add:"Agregar Módulo",add_item:"Agregar Elemento a %{module}",add_prerequisite:"Agregar Prerrequisitos a %{module}",edit:"Editar las Configuraciones del Módulo",edit_item:"Editar los Detalles del Elemento",student_progress:"Progreso del Estudiante para el Módulo"}}},fr:{context_modules:{buttons:{add:"Ajouter un module",add_item:"Ajouter un élément",update:"Mettre à jour le module"},confirm:{"delete":"Voulez-vous vraiment supprimer ce module ?",delete_item:"Voulez-vous vraiment supprimer cet élément du module ?"},context_module:{unpublish:"Annuler la publication"},context_modules:{publish:"Publier"},errors:{reorder:"Échec du classement, veuillez réessayer"},none_in_progress:"aucun en cours...",optgroup:{assignments:"Tâches",discussion_topics:"Discussions",external_tools:"Outils externes",external_urls:"URL externes",files:"Fichiers",quizzes:"Questionnaires",wiki_pages:"Pages Wiki"},points_possible_short:"%{points} points",still_needs_completing:"Doit encore terminer",titles:{add:"Ajouter un module",add_item:"Ajouter un élément à %{module}",add_prerequisite:"Ajouter des conditions préalables pour %{module}",edit:"Modifier les paramètres du module",edit_item:"Modifier les informations de l’élément",student_progress:"Progrès des étudiants pour le module"}}},ja:{context_modules:{buttons:{add:"モジュールの追加",add_item:"アイテムの追加",update:"モジュールの更新"},confirm:{"delete":"このモジュールを削除してもよろしいですか?",delete_item:"このアイテムをモジュールから削除してもよろしいですか?"},context_module:{unpublish:"未公開"},context_modules:{publish:"公開"},errors:{reorder:"並べ替えに失敗しました。もう一度やり直してください。"},none_in_progress:"進行中のものがありません",optgroup:{assignments:"課題",discussion_topics:"ディスカッション",external_tools:"外部ツール",external_urls:"外部 URL",files:"ファイル",quizzes:"クイズ",wiki_pages:"Wiki ページ"},points_possible_short:"%{points} 点",still_needs_completing:"完了までにまだ必要なもの",titles:{add:"モジュールの追加",add_item:"%{module} へのアイテムの追加",add_prerequisite:"%{module} への前提条件の追加",edit:"モジュール設定の編集",edit_item:"アイテムの詳細情報の編集",student_progress:"モジュールに対する受講生の進捗"}}},ko:{context_modules:{buttons:{add:"모듈 추가",add_item:"항목 추가",update:"모듈 업데이트"},confirm:{"delete":"이 모듈을 삭제하시겠습니까?",delete_item:"이 항목을 모듈에서 제거하시겠습니까?"},context_module:{unpublish:"게시 취소"},context_modules:{publish:"게시"},errors:{reorder:"재정렬에 실패했습니다. 다시 시도하시기 바랍니다."},none_in_progress:"진행 중인 항목 없음",optgroup:{assignments:"과제",discussion_topics:"토론",external_tools:"외부 도구",external_urls:"외부 URL",files:"파일",quizzes:"퀴즈",wiki_pages:"위키 페이지"},points_possible_short:"%{points}점",still_needs_completing:"완료해야 함",titles:{add:"모듈 추가",add_item:"%{module}에 항목 추가",add_prerequisite:"%{module}에 필수 조건 추가",edit:"모듈 설정 편집",edit_item:"항목 세부 정보 편집",student_progress:"모듈의 학생 진행률"}}},nl:{context_modules:{buttons:{add:"Voeg module toe",add_item:"Voeg item toe",update:"Werk module bij"},confirm:{"delete":"Weet je zeker dat je deze module wilt verwijderen?",delete_item:"Weet je zeker dat je dit item uit deze module wilt verwijderen?"},context_module:{unpublish:"Publicatie ongedaan maken"},context_modules:{publish:"Publiceer"},errors:{reorder:"Herordenen mislukt, probeer opnieuw."},none_in_progress:"niemand is bezig",optgroup:{assignments:"Opdrachten",discussion_topics:"Discussies",external_tools:"Externe hulpmiddelen",external_urls:"Externe URLs",files:"Bestanden",quizzes:"Testen",wiki_pages:"Wikipagina's "},points_possible_short:"%{points} punten",still_needs_completing:"Moet nog afmaken",titles:{add:"Voeg module toe",add_item:"Voeg item toe aan %{module}",add_prerequisite:"Voeg toegangsvoorwaarde toe aan %{module}",edit:"Wijzig module instellingen",edit_item:"Wijzig itemdetails",student_progress:"Studievoortgang voor de module"}}},pt:{context_modules:{buttons:{add:"Adicionar módulo",add_item:"Adicionar item",update:"Atualizar módulo"},confirm:{"delete":"Tem certeza de que deseja excluir este módulo?",delete_item:"Tem certeza de que deseja remover este item do módulo?"},context_module:{unpublish:"Anular publicação"},context_modules:{publish:"Publicar"},errors:{reorder:"Falha na reordenação, tente novamente."},none_in_progress:"nenhum em andamento",optgroup:{assignments:"Tarefas",discussion_topics:"Discussões",external_tools:"Ferramentas externas",external_urls:"URLs externos",files:"Arquivos",quizzes:"Testes",wiki_pages:"Páginas wiki"},points_possible_short:"%{points} pts",still_needs_completing:"Ainda precisa concluir",titles:{add:"Adicionar módulo",add_item:"Adicionar item a %{module}",add_prerequisite:"Adicionar prerrequisito a %{module}",edit:"Editar configurações do módulo",edit_item:"Editar detalhes do item",student_progress:"Progresso do aluno no módulo"}}},ru:{context_modules:{buttons:{add:"Добавить модуль",add_item:"Добавить элемент",update:"Обновить модуль"},confirm:{"delete":"Действительно хотите удалить этот модуль?",delete_item:"Действительно хотите удалить этот элемент из модуля?"},context_module:{unpublish:"Отметить публикацию"},context_modules:{publish:"Опубликовать"},errors:{reorder:"Сбой отметки, повторите попытку"},none_in_progress:"не выполняется",optgroup:{assignments:"Задания",discussion_topics:"Обсуждения",external_tools:"Внешние инструменты",external_urls:"Внешние URL-адреса",files:"Файлы",quizzes:"Контрольные работы",wiki_pages:"Вики-страницы"},points_possible_short:"%{points} pts",still_needs_completing:"Требуется завершить",titles:{add:"Добавить модуль",add_item:"Добавить элемент в %{module}",add_prerequisite:"Добавить предварительное условие к %{module}",edit:"Редактировать настройки модуля",edit_item:"Редактировать сведения об элементе",student_progress:"Ход выполнения студентом модуля"}}},zh:{context_modules:{buttons:{add:"添加单元",add_item:"添加项目",update:"更新单元"},confirm:{"delete":"是否确定要删除此单元?",delete_item:"是否确定要从该单元删除此项目?"},context_module:{unpublish:"取消发布"},context_modules:{publish:"发布"},errors:{reorder:"重新排序失败，请重试。"},none_in_progress:"无进展",optgroup:{assignments:"作业",discussion_topics:"讨论",external_tools:"外部工具",external_urls:"外部 URL",files:"文件",quizzes:"测验",wiki_pages:"维基页面"},points_possible_short:"%{points} 分",still_needs_completing:"仍需完成",titles:{add:"添加单元",add_item:"添加项目到 %{module}",add_prerequisite:"添加先修课程到 %{module}",edit:"编辑单元设置",edit_item:"编辑项目详细信息",student_progress:"学生学习单元的进度"}}}}})}),function(){define("compiled/util/vddTooltip",["jquery"],function(a){return function(){return a(".vdd_tooltip_link").tooltip({position:{my:"center bottom",at:"center top-10",collision:"fit fit"},tooltipClass:"center bottom vertical",content:function(){return a(a(this).data("tooltipSelector")).html()}})}})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define("compiled/views/context_modules/context_modules",["Backbone","jquery","i18n!context_modules","jquery.loadingImg"],function(b,d,e){var f,g;return f=function(b){function f(){return this.onKeyDown=a(this.onKeyDown,this),this.error=a(this.error,this),this.success=a(this.success,this),this.toggleWorkflowState=a(this.toggleWorkflowState,this),g=f.__super__.constructor.apply(this,arguments),g}return c(f,b),f.optionProperty("modules"),f.prototype.toggleWorkflowState=function(a){var b,c,e=this;return a.preventDefault(),this.$context_module=d(a.target).parents(".context_module"),b=this.$context_module.data("module-url"),this.workflow_state=this.$context_module.data("workflow-state"),c={url:b,type:"PUT",beforeSend:function(){return e.$context_module.loadingImage()},success:this.success,error:this.error},this.setRequestPublishOptions(c),d.ajax(c)},f.prototype.success=function(a){return this.$context_module.data("workflow-state",a.context_module.workflow_state),a.context_module.workflow_state==="unpublished"?this.addUnpublishAttributes():this.addPublishAttributes(),this.$context_module.loadingImage("remove")},f.prototype.error=function(a){return alert("This module could not be published"),this.$context_module.loadingImage("remove")},f.prototype.setRequestPublishOptions=function(a){return this.workflow_state==="active"?a.data="unpublish=1":a.data="publish=1"},f.prototype.addUnpublishAttributes=function(){return this.$context_module.find(".workflow-state-action").text(e.t("context_modules.publish","Publish")),this.$context_module.find(".workflow-state-icon").addClass("publish-module-link").removeClass("unpublish-module-link"),this.$context_module.find(".draft-text").removeClass("hide"),this.$context_module.addClass("unpublished_module")},f.prototype.addPublishAttributes=function(){return this.$context_module.find(".workflow-state-action").text(e.t("context_module.unpublish","Unpublish")),this.$context_module.find(".workflow-state-icon").addClass("unpublish-module-link").removeClass("publish-module-link"),this.$context_module.find(".draft-text").addClass("hide"),this.$context_module.removeClass("unpublished_module")},f.prototype.keyCodes={32:"Space",38:"UpArrow",40:"DownArrow"},f.prototype.moduleSelector="div.context_module",f.prototype.itemSelector="table.context_module_item",f.prototype.initialize=function(){return this.$contextModules=d("#context_modules"),this.$contextModules.parent().on("keydown",this.onKeyDown)},f.prototype.onKeyDown=function(a){var b,c;b=d(a.target),c="on"+this.keyCodes[a.keyCode]+"Key";if(this[c])return a.preventDefault(),this[c].call(this,a,b)},f.prototype.getFocusedElement=function(a){var b;return b=a.parents(this.itemSelector).first(),this.empty(b)||(a=b),a.is(this.itemSelector)||(b=a.parents(this.moduleSelector).first(),this.empty(b)||(a=b),a.is(this.moduleSelector)||(a=this.$contextModules)),a},f.prototype.onUpArrowKey=function(a,b){var c,d,e;c=this.getFocusedElement(b);if(c.is(this.itemSelector)){e=c.prev(this.itemSelector);if(this.empty(e)||this.$contextModules.data("dragModule"))e=c.parents(this.moduleSelector).first()}else c.is(this.moduleSelector)&&(this.$contextModules.data("dragItem")?e=this.$contextModules.data("dragItemModule"):(e=c.prev(this.moduleSelector),this.empty(e)?e=this.$contextModules:this.$contextModules.data("dragModule")||(d=e.find(this.itemSelector).last(),this.empty(d)||(e=d))));if(e&&!this.empty(e))return e.focus()},f.prototype.onDownArrowKey=function(a,b){var c,d,e;c=this.getFocusedElement(b);if(c.is(this.itemSelector))d=c.next(this.itemSelector),this.empty(d)&&!this.$contextModules.data("dragItem")&&(e=c.parents(this.moduleSelector).first(),d=e.next(this.moduleSelector));else if(c.is(this.moduleSelector)){d=c.find(this.itemSelector).first();if(this.empty(d)||this.$contextModules.data("dragModule"))d=c.next(this.moduleSelector)}else d=this.$contextModules.find(this.moduleSelector).first();if(d&&!this.empty(d))return d.focus()},f.prototype.onSpaceKey=function(a,b){var c,d,e,f;e=this.getFocusedElement(b);if(c=this.$contextModules.data("dragItem"))return e.is(c)||(f=this.$contextModules.data("dragItemModule"),e.is(this.itemSelector)&&!this.empty(e.parents(f))?e.after(c):f.find(".items").prepend(c),modules.updateModuleItemPositions(null,{item:c.parent()})),c.attr("aria-grabbed",!1),this.$contextModules.data("dragItem",null),this.$contextModules.data("dragItemModule",null),c.focus();if(d=this.$contextModules.data("dragModule"))return e.is(this.itemSelector)&&(e=e.parents(this.moduleSelector).first()),e.is(d)||(this.empty(e)||e.is(this.$contextModules)?this.$contextModules.prepend(d):e.after(d),modules.updateModulePositions()),d.attr("aria-grabbed",!1),this.$contextModules.data("dragModule",null),d.focus();if(!e.is(this.$contextModules))return e.attr("aria-grabbed",!0),e.is(this.itemSelector)?(this.$contextModules.data("dragItem",e),this.$contextModules.data("dragItemModule",e.parents(this.moduleSelector).first())):e.is(this.moduleSelector)&&this.$contextModules.data("dragModule",e),e.blur(),e.focus()},f.prototype.empty=function(a){return a.length===0},f}(b.View)})}.call(this),define("jst/assignments/VddTooltip",["compiled/handlebars_helpers"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["assignments/VddTooltip"]=b(function(a,b,c,d,e){function p(a,b){var d="",e;return d+='href="',i=c.link_href,e=i||a.link_href,typeof e===l?e=e.call(a,{hash:{}}):e===n&&(e=m.call(a,"link_href",{hash:{}})),d+=o(e)+'"',d}function q(a,b){var d="",e;return d+='\n      <div class="clearfix">\n        <dt>',i=c.due_for,e=i||a.due_for,typeof e===l?e=e.call(a,{hash:{}}):e===n&&(e=m.call(a,"due_for",{hash:{}})),d+=o(e)+"</dt>\n        <dd>",i=c.due_at,e=i||a.due_at,typeof e===l?e=e.call(a,{hash:{}}):e===n&&(e=m.call(a,"due_at",{hash:{}})),d+=o(e)+"</dd>\n      </div>\n    ",d}function r(a,b){var d="",e;return d+='\n      <div class="clearfix">\n        <dd>',i=c.more_message,e=i||a.more_message,typeof e===l?e=e.call(a,{hash:{}}):e===n&&(e=m.call(a,"more_message",{hash:{}})),d+=o(e)+"</dd>\n      </div>\n    ",d}c=c||a.helpers;var f="",g,h,i,j,k=this,l="function",m=c.helperMissing,n=void 0,o=this.escapeExpression;f+='<a title class="vdd_tooltip_link"\n  data-tooltip-selector="#vdd_tooltip_',i=c.selector,g=i||b.selector,typeof g===l?g=g.call(b,{hash:{}}):g===n&&(g=m.call(b,"selector",{hash:{}})),f+=o(g)+'"\n  ',i=c.link_href,g=i||b.link_href,h=c["if"],j=k.program(1,p,e),j.hash={},j.fn=j,j.inverse=k.noop,g=h.call(b,g,j);if(g||g===0)f+=g;f+="\n  >",i=c.link_text,g=i||b.link_text,typeof g===l?g=g.call(b,{hash:{}}):g===n&&(g=m.call(b,"link_text",{hash:{}})),f+=o(g)+'</a>\n\n<div id="vdd_tooltip_',i=c.selector,g=i||b.selector,typeof g===l?g=g.call(b,{hash:{}}):g===n&&(g=m.call(b,"selector",{hash:{}})),f+=o(g)+'" style="display:none;">\n  <dl class="vdd_tooltip_content dl-horizontal">\n    ',i=c.due_dates,g=i||b.due_dates,h=c.each,j=k.program(3,q,e),j.hash={},j.fn=j,j.inverse=k.noop,g=h.call(b,g,j);if(g||g===0)f+=g;f+="\n    ",i=c.more_message,g=i||b.more_message,h=c["if"],j=k.program(5,r,e),j.hash={},j.fn=j,j.inverse=k.noop,g=h.call(b,g,j);if(g||g===0)f+=g;return f+="\n  </dl>\n</div>",f}),c["assignments/VddTooltip"]}),define("context_modules",["INST","i18n!context_modules","jquery","compiled/views/context_modules/context_modules","compiled/util/vddTooltip","jst/assignments/VddTooltip","jquery.ajaxJSON","jquery.instructure_date_and_time","jquery.instructure_forms","jqueryui/dialog","compiled/jquery/fixDialogButtons","jquery.instructure_misc_helpers","jquery.instructure_misc_plugins","jquery.keycodes","jquery.loadingImg","jquery.templateData","vendor/date","vendor/jquery.scrollTo","jqueryui/sortable"],function(a,b,c,d,e,f){return window.modules=function(){return{updateTaggedItems:function(){},currentIndent:function(a){var b=a.attr("class").split(/\s/),c=0;for(idx=0;idx<b.length;idx++)if(b[idx].match(/^indent_/)){var d=parseInt(b[idx].substring(7),10);isNaN(d)||(c=d)}return c},updateModulePositions:function(){var a=[];c("#context_modules .context_module").each(function(){a.push(c(this).attr("id").substring("context_module_".length))});var b=c(".reorder_modules_url").attr("href");c("#context_modules").loadingImage(),c.ajaxJSON(b,"POST",{order:a.join(",")},function(a){c("#context_modules").loadingImage("remove");for(var b in a){var d=a[b];c("#context_module_"+d.context_module.id).triggerHandler("update",d)}},function(a){c("#context_modules").loadingImage("remove")})},updateModuleItemPositions:function(a,d){var e=d.item.parents(".context_module"),f=e.find(".reorder_items_url").attr("href");e.find(".content").loadingImage();var g=[];e.find(".context_module_items .context_module_item").each(function(){g.push(c(this).getTemplateData({textValues:["id"]}).id)}),c.ajaxJSON(f,"POST",{order:g.join(",")},function(a){e.find(".content").loadingImage("remove");if(a&&a.context_module&&a.context_module.content_tags)for(var b in a.context_module.content_tags){var c=a.context_module.content_tags[b].content_tag;e.find("#context_module_item_"+c.id).fillTemplateData({data:{position:c.position}})}},function(a){e.find(".content").loadingImage("remove"),e.find(".content").errorBox(b.t("errors.reorder","Reorder failed, please try again."))})},refreshProgressions:function(a){if(ENV.NO_MODULE_PROGRESSIONS)return;c("#context_modules .context_module:visible").each(function(){var a=c(this),b=a.find(".header").getTemplateData({textValues:["id"]}),d={progression_complete_count:0,progression_started_count:0};c("#progression_list .progression_"+b).each(function(){var a=c(this).getTemplateData({textValues:["workflow_state"]}).workflow_state;a=="completed"?d.progression_complete_count++:(a=="unlocked"||a=="started")&&d.progression_started_count++}),a.find(".progression_details_link").showIf(d.progression_complete_count||d.progression_started_count),a.find(".footer").fillTemplateData({data:d}).find(".progression_details_link").showIf(d.progression_complete_count||d.progression_started_count).end().find(".progression_complete").showIf(d.progression_complete_count>0).end().find(".progression_started").showIf(d.progression_started_count>0)}),c(".context_module .progression_complete").showIf(c(".context_module .prerequisites_footer:visible,.context_module_item .criterion img.not_blank").length>0),a&&(c(".loading_module_progressions_link").remove(),c(".module_progressions_link").showIf(c(".editable_context_module").length>0||c(".context_module .progression_complete:visible").length>0||c(".context_module_item.completed_item").length>0))},updateProgressions:function(a,b){var d=c(".progression_list_url").attr("href");a&&(d=d+"?user_id="+a),c(".context_module_item.progression_requirement:visible").length>0&&c(".loading_module_progressions_link").show().attr("disabled",!0),c.ajaxJSON(d,"GET",{},function(d){c(".loading_module_progressions_link").remove(),a?c("#progression_list .student_"+a+" .progressions").empty():c("#progression_list .student .progressions").empty();var e=c("#identity .user_id").text(),f=c("#progression_list_blank"),g=c("#current_user_progression_list"),h=c("#progression_list"),i={},j=[];for(var k in d)j.push(d[k]);var l=function(){c("#context_modules").hasClass("editable")||c("#context_modules .context_module").each(function(){modules.updateProgressionState(c(this))}),modules.refreshProgressions(!a),b&&b()},m=0,n=function(){var a=j.shift();if(!a){l();return}var b=a.context_module_progression;if(b.user_id==e){var d=g.find(".progression_"+b.context_module_id);d.length===0&&g.length>0&&(d=g.find(".progression_blank").clone(!0),d.removeClass("progression_blank").addClass("progression_"+b.context_module_id),g.append(d)),d.length>0&&(b.requirements_met=c.map(b.requirements_met||[],function(a){return a.id}).join(","),d.fillTemplateData({data:b}))}var k=f.clone(!0).removeAttr("id");k.fillTemplateData({data:b}),k.addClass("progression_"+b.context_module_id),k.data("progression",b);var o=i[b.user_id];o||(o=h.find(".student_"+b.user_id+" .progressions"),i[b.user_id]=o),o.append(k);if(b.workflow_state=="unlocked"||b.workflow_state=="started")i[b.user_id].found||(i[b.user_id].found=!0,o.parents(".student").fillTemplateData({data:{current_module:c("#context_module_"+b.context_module_id+" .header .name").text()}}));m++,m>=50?(m=0,setTimeout(n,150)):n()};n()},function(){b&&b()})},updateAssignmentData:function(){c.ajaxJSON(c(".assignment_info_url").attr("href"),"GET",{},function(a){c.each(a,function(a,d){$context_module_item=c("#context_module_item_"+a);var e={};d["points_possible"]!=null&&(e.points_possible_display=b.t("points_possible_short","%{points} pts",{points:"<span class='points_possible_block'>"+d.points_possible+"</span>"})),d["due_date"]!=null?e.due_date_display=c.parseFromISO(d.due_date).date_formatted:d["vdd_tooltip"]!=null&&(d.vdd_tooltip.link_href=$context_module_item.find("a.title").attr("href"),$context_module_item.find(".due_date_display").html(f(d.vdd_tooltip))),$context_module_item.fillTemplateData({data:e,htmlValues:["points_possible_display"]})}),e()},function(){})},itemClass:function(a){return a.content_type+"_"+a.content_id},updateAllItemInstances:function(a){c(".context_module_item."+modules.itemClass(a)+" .title").each(function(){c(this).text(a.title)})},editModule:function(a){var d=c("#add_context_module_form");d.data("current_module",a);var e=a.getTemplateData({textValues:["name","unlock_at","require_sequential_progress"]});d.fillFormData(e,{object_name:"context_module"});var f=!1;a.attr("id")=="context_module_new"?(f=!0,d.attr("action",d.find(".add_context_module_url").attr("href")),d.find(".completion_entry").hide(),d.attr("method","POST"),d.find(".submit_button").text(b.t("buttons.add","Add Module"))):(d.attr("action",a.find(".edit_module_link").attr("href")),d.find(".completion_entry").show(),d.attr("method","PUT"),d.find(".submit_button").text(b.t("buttons.update","Update Module"))),d.find("#unlock_module_at").prop("checked",e.unlock_at),d.find("#require_sequential_progress").attr("checked",e.require_sequential_progress=="true"||e.require_sequential_progress=="1"),d.find(".prerequisites_entry").showIf(c("#context_modules .context_module").length>1);var g=[];a.find(".prerequisites .criterion").each(function(){g.push(c(this).getTemplateData({textValues:["id","name","type"]}))}),d.find(".prerequisites_list .criteria_list").empty();for(var h in g){var i=g[h];d.find(".add_prerequisite_link:first").click(),i.type=="context_module"&&d.find(".prerequisites_list .criteria_list .criterion:last select").val(i.id)}d.find(".completion_criteria_list .criteria_list").empty(),a.find(".content .context_module_item .criterion.defined").each(function(){var a=c(this).parents(".context_module_item").getTemplateData({textValues:["id","criterion_type","min_score"]});d.find(".add_completion_criterion_link").click(),d.find(".completion_criteria_list .criteria_list .criterion:last").find(".id").val(a.id||"").change().end().find(".type").val(a.criterion_type||"").change().end().find(".min_score").val(a.min_score||"")});var j=c("#context_modules .context_module").length==1,k=a.find(".content .context_module_item").length===0;d.find(".prerequisites_list .no_prerequisites_message").showIf(g.length===0).end().find(".prerequisites_list .criteria_list").showIf(g.length!=0).end().find(".add_prerequisite_link").showIf(!j).end().find(".completion_criteria_list .no_items_message").showIf(k).end().find(".completion_criteria_list .no_criteria_message").showIf(!k&&a.find(".content .context_module_item .criterion.defined").length===0).end().find(".completion_criteria_list .criteria_list").showIf(!k).end().find(".add_completion_criterion_link").showIf(!k),a.fadeIn("fast",function(){}),a.addClass("dont_remove"),d.find(".module_name").toggleClass("lonely_entry",f),d.dialog({autoOpen:!1,modal:!0,width:600,close:function(){modules.hideEditModule(!0)}}).fixDialogButtons().dialog("option",{title:f?b.t("titles.add","Add Module"):b.t("titles.edit","Edit Module Settings"),width:f?"auto":600}).dialog("open"),a.removeClass("dont_remove"),d.find(":text:visible:first").focus().select()},hideEditModule:function(a){var b=c("#add_context_module_form").data("current_module");a&&b&&b.attr("id")=="context_module_new"&&!b.hasClass("dont_remove")&&b.remove(),c("#add_context_module_form:visible").dialog("close")},addItemToModule:function(a,b){if(!b)return c("<div/>");b.id=b.id||"new",b.type=b.type||b["item[type]"]||c.underscore(b.content_type),b.title=b.title||b["item[title]"],b.new_tab=b.new_tab?"1":"0";var d,e=b.id!="new"?c("#context_module_item_"+b.id):[];e.length?(d=e.clone(!0).removeAttr("id"),e.remove()):d=c("#context_module_item_blank").clone(!0).removeAttr("id"),d.addClass(b.type+"_"+b.id),d.addClass(b.type),d.attr("aria-label",b.title),d.fillTemplateData({data:b,id:"context_module_item_"+b.id,hrefValues:["id","context_module_id"]});for(var f=0;f<10;f++)d.removeClass("indent_"+f);d.addClass("indent_"+(b.indent||0)),d.addClass(modules.itemClass(b));var g=null;return a.find(".context_module_items").children().each(function(){var a=parseInt(c(this).getTemplateData({textValues:["position"]}).position,10);(b.position||b.position===0)&&(a||a===0)&&g==null&&a-b.position>=0&&(g=c(this))}),g?g.before(d.show()):a.find(".context_module_items").append(d.show()),d},refreshModuleList:function(){c("#module_list").find(".context_module_option").remove(),c("#context_modules .context_module").each(function(){var a=c(this).find(".header").getTemplateData({textValues:["name","id"]}),b=c(document.createElement("option"));b.val(a.id),b.attr("role","option").text("the module, "+a.name).addClass("context_module_"+a.id).addClass("context_module_option"),c("#module_list").append(b)})},filterPrerequisites:function(a,b){var d=modules.prerequisites(),e=a.attr("id").substring("context_module_".length),f=[];for(var g in b)c.inArray(b[g],d[e])==-1&&f.push(b[g]);return f},prerequisites:function(){var a={to_visit:{},visited:{}};c("#context_modules .context_module").each(function(){var b=c(this).attr("id").substring("context_module_".length);a[b]=[],c(this).find(".prerequisites .criterion").each(function(){var d=c(this).getTemplateData({textValues:["id"]}).id;c(this).hasClass("context_module_criterion")&&(a[b].push(d),a.to_visit[b+"_"+d]=!0)})});for(var b in a.to_visit)if(a.to_visit.hasOwnProperty(b)){var d=b.split("_");if(a.visited[b])continue;a.visited[b]=!0;for(var e in a[d[1]])a[d[0]].push(a[d[1]][e]),a.to_visit[d[0]+"_"+a[d[1]][e]]=!0}return delete a.to_visit,delete a.visited,a},updateProgressionState:function(a){var b=a.attr("id").substring(15),d=c("#current_user_progression_list .progression_"+b),e=d.getTemplateData({textValues:["context_module_id","workflow_state","requirements_met","collapsed","current_position"]}),a=c("#context_module_"+e.context_module_id);a.toggleClass("completed",e.workflow_state=="completed");var f=e.workflow_state;if(f=="unlocked"||f=="started")f="in progress";f=="completed"&&!a.find(".progression_requirement").length&&(f=""),a.fillTemplateData({data:{progression_state:f}}),a.toggleClass("locked_module",e.workflow_state=="locked"&&!a.hasClass("editable_context_module")),a.find(".context_module_item").each(function(){var a=parseInt(c(this).getTemplateData({textValues:["position"]}).position,10);e.current_position&&a&&e.current_position<a&&c(this).addClass("after_current_position")});if(e.requirements_met){var g=e.requirements_met.split(",");for(var h in g){var i=g[h];a.find("#context_module_item_"+i).addClass("completed_item")}}e.collapsed=="true"&&a.addClass("collapsed_module")},sortable_module_options:{connectWith:".context_module_items",handle:".move_item_link",helper:"clone",placeholder:"context_module_placeholder",forcePlaceholderSize:!0,axis:"y",containment:"#context_modules"}}}(),modules.initModuleManagement=function(){var e=new d({el:c("#content"),modules:modules});c("#unlock_module_at").change(function(){$this=c(this),$unlock_module_at_details=c(".unlock_module_at_details"),$unlock_module_at_details.showIf($this.attr("checked")),$this.attr("checked")||c("#context_module_unlock_at").val("").triggerHandler("change")}).triggerHandler("change"),c(".context_module").bind("update",function(a,b){b.context_module.unlock_at=c.parseFromISO(b.context_module.unlock_at).datetime_formatted;var d=c("#context_module_"+b.context_module.id);d.attr("aria-label",b.context_module.name),d.find(".header").fillTemplateData({data:b.context_module,hrefValues:["id"]}),d.find(".footer").fillTemplateData({data:b.context_module,hrefValues:["id"]}),d.find(".unlock_details").showIf(b.context_module.unlock_at&&Date.parse(b.context_module.unlock_at)>new Date),d.find(".footer .prerequisites").empty();for(var e in b.context_module.prerequisites){var f=b.context_module.prerequisites[e],g=c("#display_criterion_blank").clone(!0).removeAttr("id");g.fillTemplateData({data:f}),d.find(".footer .prerequisites").append(g.show())}d.find(".context_module_items .context_module_item").removeClass("progression_requirement").removeClass("min_score_requirement").removeClass("max_score_requirement").removeClass("must_view_requirement").removeClass("must_submit_requirement").removeClass("must_contribute_requirement").find(".criterion").removeClass("defined");for(var e in b.context_module.completion_requirements){var h=b.context_module.completion_requirements[e];h.criterion_type=h.type;var i=d.find("#context_module_item_"+h.id);i.find(".criterion").fillTemplateData({data:h}),i.find(".completion_requirement").fillTemplateData({data:h}),i.find(".criterion").addClass("defined"),i.addClass(h.type+"_requirement").addClass("progression_requirement")}d.find(".prerequisites_footer").showIf(b.context_module.prerequisites&&b.context_module.prerequisites.length>0),modules.refreshModuleList()}),c("#add_context_module_form").formSubmit({object_name:"context_module",processData:function(a){var b=[];return c(this).find(".prerequisites_list .criteria_list .criterion").each(function(){var a=c(this).find(".option select").val();a&&b.push("module_"+a)}),a["context_module[prerequisites]"]=b.join(","),a["context_module[completion_requirements][none]"]="none",c(this).find(".completion_criteria_list .criteria_list .criterion").each(function(){var b=c(this).find(".id").val();a["context_module[completion_requirements]["+b+"][type]"]=c(this).find(".type").val(),a["context_module[completion_requirements]["+b+"][min_score]"]=c(this).find(".min_score").val()}),a},beforeSubmit:function(a){var b=c(this).data("current_module");return b.loadingImage(),b.find(".header").fillTemplateData({data:a}),b.addClass("dont_remove"),modules.hideEditModule(),b.removeClass("dont_remove"),b},success:function(a,b){b.loadingImage("remove"),b.attr("id","context_module_"+a.context_module.id),b.data("module-url","/courses/"+a.context_module.context_id+"/modules/"+a.context_module.id),b.data("workflow-state",a.context_module.workflow_state),a.context_module.workflow_state=="unpublished"&&(b.find(".workflow-state-action").text("Publish"),b.find(".workflow-state-icon").addClass("publish-module-link").removeClass("unpublish-module-link"),b.addClass("unpublished_module")),c("#no_context_modules_message").slideUp(),b.triggerHandler("update",a)},error:function(a,b){b.loadingImage("remove")}}),c("#add_context_module_form .add_prerequisite_link").click(function(a){a.preventDefault();var b=c(this).parents("#add_context_module_form"),d=b.data("current_module"),e=c("#module_list").clone(!0).removeAttr("id"),f=b.find("#criterion_blank").clone(!0).removeAttr("id");e.find("."+d.attr("id")).remove();var g=[];c("#context_modules .context_module").each(function(){(c(this)[0]==d[0]||g.length>0)&&g.push(c(this).getTemplateData({textValues:["id"]}).id)});for(var h in g)e.find(".context_module_"+g[h]).attr("disabled",!0);f.find(".option").empty().append(e.show()),b.find(".prerequisites_list .criteria_list").append(f).show(),f.slideDown(),b.find(".no_prerequisites_message").hide(),e.focus()}),c("#add_context_module_form .add_completion_criterion_link").click(function(a){a.preventDefault();var d=c(this).parents("#add_context_module_form"),e=d.data("current_module"),f=c("#completion_criterion_option").clone(!0).removeAttr("id"),g=f.find("select.id"),h=d.find("#criterion_blank").clone(!0).removeAttr("id");h.find(".prereq_desc").remove();var i=modules.prerequisites(),j={};e.find(".content .context_module_item").not(".context_module_sub_header").each(function(){var a=c(this).getTemplateData({textValues:["id","title","type"]});a.type=="assignment"?displayType=b.t("optgroup.assignments","Assignments"):a.type=="attachment"?displayType=b.t("optgroup.files","Files"):a.type=="quiz"?displayType=b.t("optgroup.quizzes","Quizzes"):a.type=="external_url"?displayType=b.t("optgroup.external_urls","External URLs"):a.type=="context_external_tool"?displayType=b.t("optgroup.external_tools","External Tools"):a.type=="discussion_topic"?displayType=b.t("optgroup.discussion_topics","Discussions"):a.type=="wiki_page"&&(displayType=b.t("optgroup.wiki_pages","Wiki Pages"));var d=j[displayType];d||(d=j[displayType]=c(document.createElement("optgroup")),d.attr("label",displayType),g.append(d));var e=a.title,f=c(document.createElement("option"));f.val(a.id).text(e),d.append(f)}),h.find(".option").empty().append(f),f.slideDown(),d.find(".completion_criteria_list .criteria_list").append(h).show(),h.slideDown(),d.find(".no_criteria_message").hide(),g.change().focus()}),c("#completion_criterion_option .id").change(function(){var a=c(this).parents(".completion_criterion_option"),b=c("#context_module_item_"+c(this).val()).getTemplateData({textValues:["type"]});a.find(".type option").hide().attr("disabled",!0).end().find(".type option.any").show().attr("disabled",!1).end().find(".type option."+b.type).show().attr("disabled",!1),a.find(".type").val(a.find(".type option."+b.criterion_type+":first").val()),a.find(".type").change()}),c("#completion_criterion_option .type").change(function(){var a=c(this).parents(".completion_criterion_option");a.find(".min_score_box").showIf(c(this).val()=="min_score");var b=a.find(".id").val(),d=c.trim(c("#context_module_item_"+b+" .points_possible").text())||c.trim(c("#context_module_item_"+b+" .points_possible_block").text());d.length>0?(a.find(".points_possible").text(d),a.find(".points_possible_parent").show()):a.find(".points_possible_parent").hide()}),c("#add_context_module_form .delete_criterion_link").click(function(a){a.preventDefault(),c(this).parents(".criterion").slideUp(function(){c(this).remove()})}),c(".delete_module_link").live("click",function(a){a.preventDefault(),c(this).parents(".context_module").confirmDelete({url:c(this).attr("href"),message:b.t("confirm.delete","Are you sure you want to delete this module?"),success:function(a){var b=a.context_module.id;c(".context_module .prerequisites .criterion").each(function(){var a=c(this).getTemplateData({textValues:["id","type"]});a.type=="context_module"&&a.id==b&&c(this).remove()}),c(this).slideUp(function(){c(this).remove(),modules.updateTaggedItems()})}})}),c(".outdent_item_link,.indent_item_link").live("click",function(a){a.preventDefault();var b=c(this).hasClass("indent_item_link"),d=c(this).parents(".context_module_item"),e=modules.currentIndent(d);e=Math.max(Math.min(e+(b?1:-1),5),0),d.loadingImage({image_size:"small"}),c.ajaxJSON(c(this).attr("href"),"PUT",{"content_tag[indent]":e},function(a){d.loadingImage("remove");var b=c("#context_module_"+a.content_tag.context_module_id);modules.addItemToModule(b,a.content_tag),b.find(".context_module_items.ui-sortable").sortable("refresh"),modules.updateAssignmentData()},function(a){})}),c(".edit_item_link").live("click",function(a){a.preventDefault();var d=c(this).parents(".context_module_item"),e=d.getTemplateData({textValues:["title","url","indent","new_tab"]});e.indent=modules.currentIndent(d),c("#edit_item_form").find(".external_url").showIf(d.hasClass("external_url")||d.hasClass("context_external_tool")),c("#edit_item_form").find(".external_tool").showIf(d.hasClass("context_external_tool")),c("#edit_item_form").attr("action",c(this).attr("href")),c("#edit_item_form").fillFormData(e,{object_name:"content_tag"}),c("#edit_item_form").dialog({title:b.t("titles.edit_item","Edit Item Details")}).fixDialogButtons()}),c("#edit_item_form .cancel_button").click(function(a){c("#edit_item_form").dialog("close")}),c("#edit_item_form").formSubmit({beforeSubmit:function(a){c(this).loadingImage()},success:function(a){c(this).loadingImage("remove");var b=c("#context_module_"+a.content_tag.context_module_id),d=modules.addItemToModule(b,a.content_tag);b.find(".context_module_items.ui-sortable").sortable("refresh"),a.content_tag.content_id!=0&&modules.updateAllItemInstances(a.content_tag),modules.updateAssignmentData(),c(this).dialog("close")},error:function(a){c(this).loadingImage("remove"),c(this).formErrors(a)}}),c(".delete_item_link").live("click",function(a){a.preventDefault(),c(this).parents(".context_module_item").confirmDelete({url:c(this).attr("href"),message:b.t("confirm.delete_item","Are you sure you want to remove this item from the module?"),success:function(a){c(this).slideUp(function(){c(this).remove(),modules.updateTaggedItems()})}})}),c(".edit_module_link").live("click",function(a){a.preventDefault(),modules.editModule(c(this).parents(".context_module"))}),c(".add_module_link").live("click",function(a){a.preventDefault();var b=c("#context_module_blank").clone(!0).attr("id","context_module_new");c("#context_modules").append(b);var d=modules.sortable_module_options;d.update=modules.updateModuleItemPositions,b.find(".context_module_items").sortable(d),c("#context_modules.ui-sortable").sortable("refresh"),c("#context_modules .context_module .context_module_items.ui-sortable").each(function(){c(this).sortable("refresh"),c(this).sortable("option","connectWith",".context_module_items")}),modules.editModule(b)}),c(".add_module_item_link").live("click",function(d){d.preventDefault();var e=c(this).closest(".context_module");if(e.hasClass("collapsed_module")){e.find(".expand_module_link").triggerHandler("click",function(){e.find(".add_module_item_link").click()});return}if(a&&a.selectContentDialog){var f=c(this).parents(".context_module").find(".header").getTemplateData({textValues:["name","id"]}),g={for_modules:!0};g.select_button_text=b.t("buttons.add_item","Add Item"),g.holder_name=f.name,g.dialog_title=b.t("titles.add_item","Add Item to %{module}",{module:f.name}),g.submit=function(a){var b=c("#context_module_"+f.id),d=modules.addItemToModule(b,a);b.find(".context_module_items.ui-sortable").sortable("refresh");var e=b.find(".add_module_item_link").attr("rel");d.loadingImage({image_size:"small"}),c.ajaxJSON(e,"POST",a,function(c){d.loadingImage("remove"),d.remove(),c.content_tag.type=a["item[type]"],modules.addItemToModule(b,c.content_tag),b.find(".context_module_items.ui-sortable").sortable("refresh"),modules.updateAssignmentData()})},a.selectContentDialog(g)}}),c("#add_module_prerequisite_dialog .cancel_button").click(function(){c("#add_module_prerequisite_dialog").dialog("close")}),c(".delete_prerequisite_link").live("click",function(a){a.preventDefault();var b=c(this).parents(".criterion"),d=[];c(this).parents(".context_module .prerequisites .criterion").each(function(){if(c(this)[0]!=b[0]){var a=c(this).getTemplateData({textValues:["id","type"]}),e=a.type=="context_module"?"module":a.type;d.push(e+"_"+a.id)}});var e=c(this).parents(".context_module").find(".edit_module_link").attr("href"),f={"context_module[prerequisites]":d.join(",")};b.dim(),c.ajaxJSON(e,"PUT",f,function(a){c("#context_module_"+a.context_module.id).triggerHandler("update",a)})}),c("#add_module_prerequisite_dialog .submit_button").click(function(){var a=c("#add_module_prerequisite_dialog .prerequisite_module_select select").val();if(!a)return;c("#add_module_prerequisite_dialog").loadingImage();var b=[];b.push("module_"+a);var d=c("#context_module_"+c("#add_module_prerequisite_dialog").getTemplateData({textValues:["context_module_id"]}).context_module_id);d.find(".prerequisites .criterion").each(function(){b.push("module_"+c(this).getTemplateData({textValues:["id","name","type"]}).id)});var e=d.find(".edit_module_link").attr("href"),f={"context_module[prerequisites]":b.join(",")};c.ajaxJSON(e,"PUT",f,function(a){c("#add_module_prerequisite_dialog").loadingImage("remove"),c("#add_module_prerequisite_dialog").dialog("close"),c("#context_module_"+a.context_module.id).triggerHandler("update",a)},function(a){c("#add_module_prerequisite_dialog").loadingImage("remove"),c("#add_module_prerequisite_dialog").formErrors(a)})}),c(".context_module .add_prerequisite_link").live("click",function(a){a.preventDefault();var d=c(this).parents(".context_module").find(".header").getTemplateData({textValues:["name","id"]});c("#add_module_prerequisite_dialog").fillTemplateData({data:{module_name:d.name,context_module_id:d.id}});var e=c(this).parents(".context_module"),f=c("#module_list").clone(!0).removeAttr("id");f.find("."+e.attr("id")).remove();var g=[];c("#context_modules .context_module").each(function(){(c(this)[0]==e[0]||g.length>0)&&g.push(c(this).getTemplateData({textValues:["id"]}).id)});for(var h in g)f.find(".context_module_"+g[h]).attr("disabled",!0);c("#add_module_prerequisite_dialog").find(".prerequisite_module_select").empty().append(f.show()),c("#add_module_prerequisite_dialog").dialog({title:b.t("titles.add_prerequisite","Add Prerequisite to %{module}",{module:d.name}),width:400})}),c("#add_context_module_form .cancel_button").click(function(a){modules.hideEditModule(!0)}),setTimeout(function(){var a=[];c("#context_modules .context_module_items").each(function(){a.push(c(this))});var b=function(){if(a.length>0){var c=a.shift(),d=modules.sortable_module_options;d.update=modules.updateModuleItemPositions,c.sortable(d),setTimeout(b,10)}};b(),c("#context_modules").sortable({handle:".reorder_module_link",helper:"clone",containment:"#context_modules_sortable_container",axis:"y",update:modules.updateModulePositions}),modules.refreshModuleList(),modules.refreshed=!0},1e3)},c(document).ready(function(){c(".datetime_field").datetime_field(),c(".context_module").live("mouseover",function(){c(".context_module_hover").removeClass("context_module_hover"),c(this).addClass("context_module_hover")}),c(".context_module_item").live("mouseover focus",function(){c(".context_module_item_hover").removeClass("context_module_item_hover"),c(this).addClass("context_module_item_hover")});var a=null,d=function(a){a.hasClass("context_module")?(c(".context_module_hover").removeClass("context_module_hover"),c(".context_module_item_hover").removeClass("context_module_item_hover"),a.addClass("context_module_hover")):a.hasClass("context_module_item")&&(c(".context_module_item_hover").removeClass("context_module_item_hover"),c(".context_module_hover").removeClass("context_module_hover"),a.addClass("context_module_item_hover"),a.parents(".context_module").addClass("context_module_hover")),a.find(":tabbable:first").focus()};c(document).keycodes("j k",function(b){a=c(".context_module_hover:visible,.context_module_item_hover:visible").filter(":last");if(a.length===0){a=c(".context_module:visible:first"),d(a);return}var e="prev",f=null;b.keyString=="j"?a.hasClass("context_module")?(f=a.find(".context_module_item:visible:first"),f.length===0&&(f=a.next(".context_module"))):a.hasClass("context_module_item")&&(f=a.next(".context_module_item:visible"),f.length===0&&(f=a.parents(".context_module").next(".context_module"))):b.keyString=="k"&&(a.hasClass("context_module")?(f=a.prev(".context_module").find(".context_module_item:visible:last"),f.length===0&&(f=a.prev(".context_module"))):a.hasClass("context_module_item")&&(f=a.prev(".context_module_item:visible"),f.length===0&&(f=a.parents(".context_module")))),f&&f.length>0&&(a=f),d(a)}).keycodes("e d i o",function(b){if(!a||a.length===0)return;b.keyString=="e"?a.find(".edit_link:first:visible").click():b.keyString=="d"?a.find(".delete_link:first:visible").click():b.keyString=="i"?a.find(".indent_item_link:first:visible").click():b.keyString=="o"&&a.find(".outdent_item_link:first:visible").click()}).keycodes("n",function(a){a.keyString=="n"&&c(".add_module_list:visible:first").click()}),c(".context_module:first .content:visible").length==0&&c("html,body").scrollTo(c(".context_module .content:visible").filter(":first").parents(".context_module")),c("#context_modules").hasClass("editable")&&setTimeout(modules.initModuleManagement,1e3),modules.updateProgressions(),modules.refreshProgressions(),modules.updateAssignmentData(),c(".context_module").find(".expand_module_link,.collapse_module_link").bind("click",function(a,b){a.preventDefault();var d=null;b&&c.isFunction(b)&&(d=b,b=null);var e=c(this).hasClass("collapse_module_link")?"1":"0",f=c(this).parents(".context_module"),g=f.find(".content .context_module_items").children().length===0,h=function(a){var b=function(){f.find(".collapse_module_link").showIf(f.find(".content:visible").length>0),f.find(".expand_module_link").showIf(f.find(".content:visible").length===0),f.find(".content:visible").length>0?(f.find(".footer .manage_module").css("display",""),f.toggleClass("collapsed_module",!1)):(f.find(".footer .manage_module").css("display",""),f.toggleClass("collapsed_module",!0)),d&&c.isFunction(d)&&d()};a?(f.find(".content").show(),b()):f.find(".content").slideToggle(b)};(g||b)&&f.loadingImage();var i=c(this).attr("href");b&&(i=f.find(".edit_module_link").attr("href")),c.ajaxJSON(i,b?"GET":"POST",{collapse:e},function(a){if(b){f.loadingImage("remove");var d=a,e=function(){var a=d.shift();a?(modules.addItemToModule(f,a.content_tag),e()):(f.find(".context_module_items.ui-sortable").sortable("refresh"),h(!0),modules.updateProgressionState(f),c("#context_modules").triggerHandler("slow_load"))};e()}else if(g){f.loadingImage("remove");for(var i in a)modules.addItemToModule(f,a[i].content_tag);f.find(".context_module_items.ui-sortable").sortable("refresh"),h(),modules.updateProgressionState(f)}},function(a){f.loadingImage("remove")}),(e=="1"||!g)&&h()}),c(".refresh_progressions_link").click(function(a){a.preventDefault(),c(this).addClass("refreshing");var b=c(this),d=c("#student_progression_dialog").find(".student.selected_side_tab:first").getTemplateData({textValues:["id"]}).id;d&&modules.updateProgressions(d,function(){b.removeClass("refreshing"),b.blur(),c("#student_progression_dialog").find(".student.selected_side_tab:first").click()})}),c("#student_progression_dialog").delegate(".student","click",function(a){c("#student_progression_dialog").find(".selected_side_tab").removeClass("selected_side_tab"),c(this).addClass("selected_side_tab"),a.preventDefault();var d=c(this).getTemplateData({textValues:["id"]}).id,e=c("#progression_list .student_"+d+":first");c("#context_modules .context_module:visible").each(function(){var a=c(this),d=a.find(".header").getTemplateData({textValues:["id","name"]}),f=c("#student_progression_dialog .module_"+d.id);d.progress=e.find(".progression_"+d.id+":first").getTemplateData({textValues:["workflow_state"]}).workflow_state,d.progress=d.progress||"no information";var g="nothing";d.progress=="unlocked"?(g="in_progress",d.progress="in progress"):d.progress=="started"?(g="in_progress",d.progress="in progress"):d.progress=="completed"?g="completed":d.progress=="locked"&&(g="locked"),f.find(".still_need_completing").empty();if(d.progress=="in progress"){var h=c("#context_module_"+d.id+" .context_module_item.progression_requirement"),i=e.find(".progression_"+d.id).data("progression"),j=[];h.each(function(){var a=c(this),b={id:a.attr("id").substring(20)};a.hasClass("must_view_requirement")?b.type="must_view":a.hasClass("min_score_requirement")?b.type="min_score":a.hasClass("max_score_requirement")?b.type="max_score":a.hasClass("must_contribute_requirement")?b.type="must_contribute":a.hasClass("must_submit_requirement")&&(b.type="must_submit");var d=!1;if(i&&i.requirements_met)for(var e=0;e<i.requirements_met.length;e++){var f=i.requirements_met[e];f.id==b.id&&f.type==b.type&&(d=!0)}d||j.push(a.find(".title:first").text())}),f.find(".still_need_completing").append("<b>"+b.t("still_needs_completing","Still Needs to Complete")+"</b><br/>").append(j.join("<br/>"))}f.removeClass("locked").removeClass("in_progress").removeClass("completed").addClass(g),d.progressString=d.progress,f.fillTemplateData({data:d})})}),c(".module_progressions_link").click(function(a){a.preventDefault();var d=c("#student_progression_dialog"),e=d.find(".student_list");e.find(".student:not(.blank)").remove(),d.find(".side_tabs_content tbody .module:not(.blank)").remove();var f=c("#context_modules .context_module:visible"),g=[];f.each(function(){var a=c(this),b=a.attr("id").substring(15);g.push(b)}),c("#progression_list .student").each(function(){var a=d.find(".student.blank:first").clone(!0).removeClass("blank"),f=c(this),g=f.getTemplateData({textValues:["name","id","current_module"]});g.current_module=g.current_module||b.t("none_in_progress","none in progress"),a.find("a").attr("href","#"+g.id),a.fillTemplateData({data:g}),e.append(a.show())}),f.each(function(){var a=c(this),b=a.find(".header").getTemplateData({textValues:["id","name"]}),e=d.find(".module.blank:first").clone(!0).removeClass("blank");e.addClass("module_"+b.id),e.fillTemplateData({data:b}),d.find(".side_tabs_content tbody").append(e.show())}),c("#student_progression_dialog").dialog({width:800,open:function(){c(this).find(".student:not(.blank):first .name").click()}})}),c(".context_module .progression_details_link").click(function(a){a.preventDefault();var d=c(this).parents(".context_module").find(".header").getTemplateData({textValues:["id","name"]});d.module_name=d.name;var e=c("#module_progression_dialog");e.fillTemplateData({data:d}),e.find("ul").empty(),e.find(".progression_list").hide(),c("#progression_list .student").each(function(){var a=c(this).find(".progressions .progression_"+d.id),b=a.getTemplateData({textValues:["context_module_id","workflow_state"]});b.workflow_state=b.workflow_state||"locked",b.name=c(this).getTemplateData({textValues:["name"]}).name,e.find("."+b.workflow_state+"_list").show().find("ul").show().append(c("<li />").text(b.name))}),c("#module_progression_dialog").dialog({title:b.t("titles.student_progress","Student Progress for Module"),width:500})}),c(document).fragmentChange(function(a,b){var d=c(b.replace(/module/,"context_module"));d.hasClass("collapsed_module")&&d.find(".expand_module_link").triggerHandler("click")});var e=!1,f=ENV.COLLAPSED_MODULES;for(var g in f)c("#context_module_"+f[g]).addClass("collapsed_module");var h=[],i=c("#context_modules .context_module");i.length||c("#no_context_modules_message").show(),i.each(function(){modules.updateProgressionState(c(this))}),i.filter(":visible").each(function(){c(this).find(".content:visible").length>0?e=!0:e&&h.push(c(this))}),c("#context_modules").bind("slow_load",function(){var a=h.shift();a&&a.find(".expand_module_link:first").triggerHandler("click",!0)})}),modules}),function(){require(["course","context_modules"])}.call(this),define("compiled/bundles/course",function(){})