(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define(["jquery","i18n!calendar","underscore","compiled/calendar/CalendarDefaults","vendor/jquery.ba-tinypubsub"],function(b,c,d,e){var f;return f=function(){function f(c,f){this.mainCalendar=f,this.refetchEvents=a(this.refetchEvents,this),this.visibleContextListChanged=a(this.visibleContextListChanged,this),this.eventRender=a(this.eventRender,this),this.dayClick=a(this.dayClick,this),this.getEvents=a(this.getEvents,this),this.calendar=b(c),this.calendar.fullCalendar(d.defaults({height:240,header:{left:"prev",center:"title",right:"next"},dayClick:this.dayClick,events:this.getEvents,eventRender:this.eventRender},e),b.subscribe({"Calendar/visibleContextListChanged":this.visibleContextListChanged,"Calendar/refetchEvents":this.refetchEvents}))}return f.prototype.getEvents=function(a,b,c){return this.calendar.find(".fc-content td").removeClass("event slot-available").removeAttr("title"),this.mainCalendar.getEvents(a,b,c)},f.prototype.dayClick=function(a){return this.mainCalendar.gotoDate(a)},f.prototype.eventRender=function(a,b,d){var e,f,g,h,i,j;return f=d.dateCell(a.start),g=d.element.find("tr:nth-child("+(f.row+1)+") td:nth-child("+(f.col+1)+")"),g.addClass("event"),h=c.t("event_on_this_day","There is an event on this day"),e=(i=this.mainCalendar.displayAppointmentEvents)!=null?i.id:void 0,e&&e===((j=a.calendarEvent)!=null?j.appointment_group_id:void 0)&&a.object.available_slots&&(g.addClass("slot-available"),h=c.t("open_appointment_on_this_day","There is an open appointment on this day")),g.attr("title",h),!1},f.prototype.visibleContextListChanged=function(a){return this.calendar.fullCalendar("refetchEvents")},f.prototype.refetchEvents=function(){return this.calendar.fullCalendar("refetchEvents")},f}()})}).call(this)