(function(){var a={}.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};define(["jquery","underscore","Backbone","jst/roles/permissionButton"],function(a,c,d,e){var f,g;return f=function(d){function f(){return g=f.__super__.constructor.apply(this,arguments),g}return b(f,d),f.prototype.template=e,f.prototype.tagName="td",f.prototype.className="permissionButtonView",f.prototype.events={"change input[type=radio]":"updateRole"},f.prototype.initialize=function(){f.__super__.initialize.apply(this,arguments);if(this.options.permission_name)return this.permission_name=this.options.permission_name},f.prototype.toJSON=function(){var a;return a=f.__super__.toJSON.apply(this,arguments),a.enableChecked=this.isEnabled(),a.enableAndLockChecked=this.isEnabledAndLocked(),a.disableChecked=this.isDisabled(),a.disableAndLockChecked=this.isDisabledAndLocked(),a.systemDefaultChecked=this.isDefault(),a.systemDefaultLockedChecked=this.isDefaultAndLocked(),a.readOnly=this.isReadOnly(),a["default"]=this.isDefault()||this.isDefaultAndLocked(),a.addDefaultTitle=this.isDefault()||this.isDefaultAndLocked()&&!this.isReadOnly(),a},f.prototype.afterRender=function(){return this.setPreviewIcons(),this.setDataAttributes(),this.setTooltips()},f.prototype.setDataAttributes=function(){return this.$el.attr("data-role_name",this.model.id),this.$el.attr("data-permission_name",this.permission_name)},f.prototype.setTooltips=function(){this.isReadOnly()||this.$el.find(".icon-check").attr("title","Enabled").attr("data-tooltip",""),this.isReadOnly()||this.$el.find(".icon-x").attr("title","Disabled").attr("data-tooltip","");if(!this.isReadOnly())return this.$el.find(".icon-lock").attr("title","Locked").attr("data-tooltip","")},f.prototype.setPreviewIcons=function(){if(this.isEnabled())return this.setEnabledIcon();if(this.isEnabledAndLocked())return this.setEnabledLockedIcon();if(this.isDisabled())return this.setDisabledIcon();if(this.isDisabledAndLocked())return this.setDisabledLockedIcon();if(this.isDefault())return this.setDefaultIcon();if(this.isDefaultAndLocked())return this.setDefaultAndLockedIcon()},f.prototype.updateRole=function(b){b.preventDefault();switch(a(b.target).attr("id")){case"button-"+this.cid+"-0":this.$el.find("a.btn").removeClass("default_permission"),this.enable();break;case"button-"+this.cid+"-1":this.$el.find("a.btn").removeClass("default_permission"),this.enableAndLock();break;case"button-"+this.cid+"-2":this.$el.find("a.btn").removeClass("default_permission"),this.disable();break;case"button-"+this.cid+"-3":this.$el.find("a.btn").removeClass("default_permission"),this.disableAndLock();break;case"button-"+this.cid+"-4":this.$el.find("a.btn").addClass("default_permission"),this.setSystemDefault();break;case"button-"+this.cid+"-5":this.$el.find("a.btn").addClass("default_permission"),this.setSystemDefaultAndLocked()}return this.setPreviewIcons(),this.closeMenu(),this.saveModel()},f.prototype.saveModel=function(){return this.model.save({},{failure:function(){return alert("Permission was not be saved!")}})},f.prototype.closeMenu=function(){return this.$el.children(".btn-group").removeClass("open")},f.prototype.enable=function(){return this.model.get("permissions")[this.permission_name].enabled=!0,this.model.get("permissions")[this.permission_name].explicit=!0,this.model.get("permissions")[this.permission_name].locked=!1},f.prototype.enableAndLock=function(){return this.model.get("permissions")[this.permission_name].enabled=!0,this.model.get("permissions")[this.permission_name].explicit=!0,this.model.get("permissions")[this.permission_name].locked=!0},f.prototype.disable=function(){return this.model.get("permissions")[this.permission_name].enabled=!1,this.model.get("permissions")[this.permission_name].explicit=!0,this.model.get("permissions")[this.permission_name].locked=!1},f.prototype.disableAndLock=function(){return this.model.get("permissions")[this.permission_name].enabled=!1,this.model.get("permissions")[this.permission_name].explicit=!0,this.model.get("permissions")[this.permission_name].locked=!0},f.prototype.setSystemDefault=function(){return this.model.get("permissions")[this.permission_name].locked=!1,this.model.get("permissions")[this.permission_name].explicit=!1},f.prototype.setSystemDefaultAndLocked=function(){return this.model.get("permissions")[this.permission_name].locked=!0,this.model.get("permissions")[this.permission_name].explicit=!1},f.prototype.isEnabled=function(){return this.model.get("permissions")[this.permission_name].enabled&&!this.isLocked()&&this.isExplicit()},f.prototype.isEnabledAndLocked=function(){return this.model.get("permissions")[this.permission_name].enabled&&this.isLocked()&&this.isExplicit()},f.prototype.isDisabled=function(){return!this.model.get("permissions")[this.permission_name].enabled&&!this.isLocked()&&this.isExplicit()},f.prototype.isDisabledAndLocked=function(){return!this.model.get("permissions")[this.permission_name].enabled&&this.isLocked()&&this.isExplicit()},f.prototype.isDefault=function(){return!this.isExplicit()&&!this.isLocked()},f.prototype.isDefaultAndLocked=function(){return!this.isExplicit()&&this.isLocked()},f.prototype.isReadOnly=function(){return this.model.get("permissions")[this.permission_name].readonly},f.prototype.isExplicit=function(){return this.model.get("permissions")[this.permission_name].explicit},f.prototype.isLocked=function(){return this.model.get("permissions")[this.permission_name].locked},f.prototype.setButtonPreview=function(a){var b;return b=this.$el.find("label[for=button-"+this.cid+"-"+a+"] i").clone(),this.$el.find("a.dropdown-toggle").html(b)},f.prototype.setEnabledIcon=function(){return this.setButtonPreview(0)},f.prototype.setEnabledLockedIcon=function(){return this.setButtonPreview(1)},f.prototype.setDisabledIcon=function(){return this.setButtonPreview(2)},f.prototype.setDisabledLockedIcon=function(){return this.setButtonPreview(3)},f.prototype.setDefaultIcon=function(){return c.isUndefined(this.model.get("permissions")[this.permission_name].prior_default)?this.model.get("permissions")[this.permission_name].enabled?this.setEnabledIcon():this.setDisabledIcon():this.model.get("permissions")[this.permission_name].prior_default?this.setEnabledIcon():this.setDisabledIcon()},f.prototype.setDefaultAndLockedIcon=function(){return c.isUndefined(this.model.get("permissions")[this.permission_name].prior_default)?this.model.get("permissions")[this.permission_name].enabled?this.setEnabledLockedIcon():this.setDisabledLockedIcon():this.model.get("permissions")[this.permission_name].prior_default?this.setEnabledLockedIcon():this.setDisabledLockedIcon()},f}(d.View)})}).call(this)