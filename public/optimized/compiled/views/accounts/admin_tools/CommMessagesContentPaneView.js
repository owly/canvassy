(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define(["Backbone","jquery","i18n!comm_messages","jst/accounts/admin_tools/commMessagesContentPane","jst/accounts/admin_tools/commMessagesSearchOverview","jquery.instructure_date_and_time"],function(b,d,e,f,g){var h,i;return h=function(b){function h(){return this.getDisplayDateText=a(this.getDisplayDateText,this),this.renderOverviewDisplay=a(this.renderOverviewDisplay,this),this.buildOverviewText=a(this.buildOverviewText,this),this.onFail=a(this.onFail,this),this.fetchMessages=a(this.fetchMessages,this),i=h.__super__.constructor.apply(this,arguments),i}return c(h,b),h.child("searchForm","#commMessagesSearchForm"),h.child("resultsView","#commMessagesSearchResults"),h.prototype.template=f,h.prototype.els={"#commMessagesSearchOverview":"$overview"},h.prototype.attach=function(){return this.collection.on("setParams",this.fetchMessages)},h.prototype.fetchMessages=function(){return this.buildOverviewText(),this.collection.fetch().fail(this.onFail)},h.prototype.onFail=function(){return this.collection.reset(),this.resultsView.detachScroll()},h.prototype.buildOverviewText=function(){var a;return a=d.ajax({url:"/users/"+d("#userIdSearchField").val()+".json",type:"GET",success:this.renderOverviewDisplay,error:this.$overview.hide()}),a.promise()},h.prototype.renderOverviewDisplay=function(a){var b;return b=d(this.searchForm.el).toJSON(),this.$overview.hide(),this.$overview.html(g({user:a.name,start_date:this.getDisplayDateText(b.start_time,e.t("from_beginning","the beginning")),end_date:this.getDisplayDateText(b.end_time,e.t("to_now","now"))})),this.$overview.show()},h.prototype.getDisplayDateText=function(a,b){return a?d.parseFromISO(d.dateToISO8601UTC(d.unfudgeDateForProfileTimezone(a))).datetime_formatted:b},h}(b.View)})}).call(this)