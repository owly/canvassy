(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define(["jquery","i18n!external_tools","str/htmlEscape","jst/ExternalTools/IndexView","compiled/views/ExternalTools/AddAppView","compiled/views/ExternalTools/EditView","compiled/views/ExternalTools/AppFullView","compiled/models/ExternalTool"],function(b,d,e,f,g,h,i,j){var k,l;return k=function(k){function m(){return this.filterApps=a(this.filterApps,this),this.onToolSync=a(this.onToolSync,this),this.showAppCenterView=a(this.showAppCenterView,this),this.showExternalToolsView=a(this.showExternalToolsView,this),this.hideAppCenterView=a(this.hideAppCenterView,this),this.hideExternalToolsView=a(this.hideExternalToolsView,this),l=m.__super__.constructor.apply(this,arguments),l}return c(m,k),m.child("appCenterView","[data-view=appCenter]"),m.child("externalToolsView","[data-view=externalTools]"),m.prototype.template=f,m.prototype.els={".view_tools_link":"$viewToolsLink",".view_app_center_link":"$viewAppCenterLink",".add_tool_link":"$addToolLink","#app_center_filter":"$appCenterFilter","[data-view=appFull]":"$appFull"},m.prototype.events={"click .view_tools_link":"showExternalToolsView","click .view_app_center_link":"showAppCenterView","click .app":"showAppFullView","click .add_tool_link":"addTool","click [data-edit-external-tool]":"editTool","click [data-delete-external-tool]":"deleteTool","change #app_center_filter":"filterApps","keyup #app_center_filter":"filterApps"},m.prototype.currentAppCenterPosition=0,m.prototype.afterRender=function(){return this.options.appCenterEnabled?(this.appCenterView.collection.fetch(),this.showAppCenterView()):this.showExternalToolsView()},m.prototype.hideExternalToolsView=function(){return this.externalToolsView.hide(),this.$viewToolsLink.show(),this.$addToolLink.hide()},m.prototype.hideAppCenterView=function(){this.currentAppCenterPosition=b(document).scrollTop(),this.appCenterView.hide(),this.$appCenterFilter.hide();if(this.options.appCenterEnabled)return this.$viewAppCenterLink.show()},m.prototype.removeAppFullView=function(){if(this.appFullView)return this.appFullView.remove()},m.prototype.showExternalToolsView=function(){return this.removeAppFullView(),this.hideAppCenterView(),this.options.appCenterEnabled||this.$viewAppCenterLink.hide(),this.$viewToolsLink.hide(),this.$addToolLink.show(),this.externalToolsView.collection.fetch(),this.externalToolsView.show()},m.prototype.showAppCenterView=function(){return this.removeAppFullView(),this.hideExternalToolsView(),this.$viewAppCenterLink.hide(),this.appCenterView.show(),this.$appCenterFilter.show(),b(document).scrollTop(this.currentAppCenterPosition)},m.prototype.showAppFullView=function(a){var b;return this.hideExternalToolsView(),this.hideAppCenterView(),b=this.$(a.currentTarget).data("view"),this.appFullView=new i({model:b.model}),this.appFullView.on("cancel",this.showAppCenterView,this),this.appFullView.on("addApp",this.addApp,this),this.appFullView.render(),this.$appFull.append(this.appFullView.$el)},m.prototype.addApp=function(){var a;return a=new j,a.on("sync",this.onToolSync),this.addAppView=(new g({app:this.appFullView.model,model:a})).render()},m.prototype.addTool=function(){var a;return a=new j,a.on("sync",this.onToolSync),this.editView=(new h({model:a})).render()},m.prototype.editTool=function(a){var b,c;return c=this.$(a.currentTarget).closest(".external_tool_item").data("view"),b=c.model,b.on("sync",this.onToolSync),this.editView=(new h({model:b})).render()},m.prototype.onToolSync=function(a){return this.addAppView&&this.addAppView.remove(),this.editView&&this.editView.remove(),this.showExternalToolsView(),b.flashMessage(e(d.t("app_saved_message","%{app} saved successfully!",{app:a.get("name")})))},m.prototype.filterApps=function(a){return this.appCenterView.filterText=this.$appCenterFilter.val(),this.appCenterView.render()},m.prototype.deleteTool=function(a){var c,e,f,g,h=this;return g=this.$(a.currentTarget).closest(".external_tool_item").data("view"),f=g.model,e=d.t("remove_tool","Are you sure you want to remove this tool?"),c=b("<div>"+e+"</div>").dialog({modal:!0,resizable:!1,title:d.t("delete","Delete")+" "+f.get("name")+"?",buttons:[{text:d.t("buttons.cancel","Cancel"),click:function(){return c.dialog("close")}},{text:d.t("buttons.delete","Delete"),click:function(){return f.destroy(),h.externalToolsView.collection.fetch(),c.dialog("close")}}]})},m}(Backbone.View)})}).call(this)