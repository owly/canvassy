(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define(["Backbone","jquery","jst/ExternalTools/AppFullView","compiled/views/PaginatedCollectionView","compiled/views/ExternalTools/AppReviewView","compiled/views/ExternalTools/RateToolView","compiled/collections/PaginatedCollection","compiled/models/AppReview","vendor/jquery.raty"],function(b,d,e,f,g,h,i,j){var k,l;return k=function(b){function f(){return this.addApp=a(this.addApp,this),this.renderItem=a(this.renderItem,this),l=f.__super__.constructor.apply(this,arguments),l}return c(f,b),f.prototype.template=e,f.prototype.itemView=g,f.prototype.className="app_full",f.prototype.events={"click .add_app":"addApp","click .app_cancel":"cancel","click .rate_app":"rateApp"},f.prototype.initialize=function(){return this.collection=new i,f.__super__.initialize.apply(this,arguments),this.render(),this.collection.resourceName="app_center/apps/"+this.model.id+"/reviews",this.collection.fetch()},f.prototype.afterRender=function(){return this.$(".app-star").raty({readOnly:!0,score:this.model.get("avg_rating"),path:"/images/raty/"})},f.prototype.renderItem=function(a){if(a.get("comments").length>0)return f.__super__.renderItem.apply(this,arguments)},f.prototype.refresh=function(){return this.collection.resourceName.match(/force_refresh/)||(this.collection.resourceName=""+this.collection.resourceName+"?force_refresh=1"),this.collection.fetch()},f.prototype.addApp=function(a){return a&&a.preventDefault(),this.trigger("addApp",this)},f.prototype.cancel=function(a){return a&&a.preventDefault(),this.trigger("cancel",this)},f.prototype.rateApp=function(a){var b=this;return a&&a.preventDefault(),d("#rate_app_loader").show(),this.review=new j,this.review.on("sync",this.refresh,this),this.review.resourceName="app_center/apps/"+this.model.id+"/reviews/self",this.rateAppView=new h({model:this.review}),this.review.fetch({success:function(){return b.rateAppView.render(),d("#rate_app_loader").hide()},error:function(){return b.rateAppView.render(),d("#rate_app_loader").hide()}})},f}(f)})}).call(this)