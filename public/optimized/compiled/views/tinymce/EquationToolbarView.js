(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define(["i18n!editor","jquery","Backbone","jst/tinymce/EquationToolbarView","mathquill"],function(b,d,e,f){var g,h;return g=function(b){function e(){return this.addMathJaxEvents=a(this.addMathJaxEvents,this),h=e.__super__.constructor.apply(this,arguments),h}return c(e,b),e.prototype.template=f,e.prototype.els={"#mathjax-view .mathquill-toolbar":"$toolbar","#mathjax-editor":"$matheditor"},e.prototype.render=function(){return this.cacheEls(),this.$toolbar.append(this.template()),d("#mathjax-view .mathquill-tab-bar li a").click(function(){return d("#mathjax-view .mathquill-tab-bar li").removeClass("mathquill-tab-selected"),d("#mathjax-view .mathquill-tab-pane").removeClass("mathquill-tab-pane-selected"),d(this).parent().addClass("mathquill-tab-selected"),d(this.href.replace(/.*#/,"#")).addClass("mathquill-tab-pane-selected")}),d("#mathjax-view .mathquill-tab-bar li:first-child").addClass("mathquill-tab-selected"),d.getScript("https://c328740.ssl.cf1.rackcdn.com/mathjax/2.1-latest/MathJax.js?config=TeX-AMS_HTML.js",this.addMathJaxEvents)},e.prototype.addMathJaxEvents=function(){var a;return a=function(){var a,b;a=MathJax.Hub.getAllJax("mathjax-preview")[0];if(a)return b=d("#mathjax-editor").val(),MathJax.Hub.Queue(["Text",a,b])},d("#mathjax-view a.mathquill-rendered-math").mousedown(function(a){return a.stopPropagation()}).click(function(){var b,c,d,e,f,g;return f=this.title+" ",c=document.getElementById("mathjax-editor"),document.selection?(c.focus(),e=document.selection.createRange(),e.text=f):c.selectionStart||c.selectionStart==="0"?(d=c.selectionStart,b=c.selectionEnd,g=c.value,c.value=g.substring(0,d)+f+g.substring(b,g.length)):c.value+=f,a()}),this.renderPreview=a,this.$matheditor.keyup(a),this.$matheditor.bind("paste",a)},e}(e.View)})}).call(this)