(function(){var a={}.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};define(["underscore","Backbone","jst/courses/Syllabus"],function(a,c,d){var e,f;return e=function(c){function e(){return f=e.__super__.constructor.apply(this,arguments),f}return b(e,c),e.prototype.template=d,e.prototype.initialize=function(a){return this.can_read=a.can_read,this.is_valid_user=a.is_valid_user,e.__super__.initialize.apply(this,arguments)},e.prototype.toJSON=function(){var b,c,d,f,g,h,i,j,k,l,m,n,o,p,q;l=new Date,o=new Date(l.getFullYear(),l.getMonth(),l.getDate()),g=this.can_read,h=this.can_read&&this.is_valid_user,n={},j=null,k=null,b=function(b,c){var d,e,f,i,l,m,p,q,r,s,t,u,v;m=c.related_id,m==null&&(m=c.id),c.assignment?(s="assignment",g&&(i=c.html_url)):(s="event",h&&(i=c.html_url)),r=c.title,c.start_at&&(p=$.fudgeDateForProfileTimezone(Date.parse(c.start_at))),c.end_at&&(e=$.fudgeDateForProfileTimezone(Date.parse(c.end_at)));if((t=c["assignment"])!=null?t.due_at:void 0)d=$.fudgeDateForProfileTimezone(Date.parse(c.assignment.due_at));return l=null,a.each((u=c.assignment_overrides)!=null?u:[],function(a){return l==null&&(l={}),l.title=a.title}),q=null,p&&(q=new Date(p.getFullYear(),p.getMonth(),p.getDate())),f=null,e&&(f=new Date(e.getFullYear(),e.getMonth(),e.getDate())),!j||((v=j["date"])!=null?v.getTime():void 0)!==(q!=null?q.getTime():void 0)?(j={date:q,passed:q&&q<o,events:[]},b.push(j),k=null):k&&(k.last=!1),k={related_id:m,type:s,title:r,html_url:i,start_at:p,end_at:e,due_at:d,same_day:(q!=null?q.getTime():void 0)===(f!=null?f.getTime():void 0),same_time:(p!=null?p.getTime():void 0)===(e!=null?e.getTime():void 0),last:!0,override:l,json:c},j.events.push(k),m in n||(n[m]=[]),n[m].push(k),b},c=a.reduce(e.__super__.toJSON.apply(this,arguments),b,[]),m=!1;for(i in n){f=n[i];if(f.length===1)f[0].override=null;else for(p=0,q=f.length;p<q;p++)d=f[p],m|=d.override!==null}return{dates:c,overrides_present:m}},e}(c.View)})}).call(this)