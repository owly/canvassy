(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define(["compiled/models/CreateUserList","underscore","i18n!create_users_view","compiled/views/DialogFormView","jst/courses/roster/createUsers","jst/courses/roster/createUsersWrapper","vendor/jquery.placeholder"],function(b,d,e,f,g,h){var i,j;return i=function(f){function i(){return this.maybeShowPrivileges=a(this.maybeShowPrivileges,this),j=i.__super__.constructor.apply(this,arguments),j}return c(i,f),i.optionProperty("rolesCollection"),i.optionProperty("courseModel"),i.prototype.defaults={width:700,height:500},i.prototype.els={"#privileges":"$privileges","#user_list_textarea":"$textarea"},i.prototype.events=d.extend({},i.prototype.events,{"click .createUsersStartOver":"startOver","click .createUsersStartOverFrd":"startOverFrd","change #enrollment_type":"changeEnrollment","click #enrollment_type":"changeEnrollment","click .dialog_closer":"close"}),i.prototype.template=g,i.prototype.wrapperTemplate=h,i.prototype.initialize=function(){var a;return(a=this.model)==null&&(this.model=new b),i.__super__.initialize.apply(this,arguments)},i.prototype.attach=function(){return this.model.on("change:step",this.render,this),this.model.on("change:enrollment_type",this.maybeShowPrivileges)},i.prototype.maybeShowPrivileges=function(){var a,b;return a=d.findWhere(this.model.get("roles"),{name:this.model.get("enrollment_type")}),!a||(b=a.base_role_name)!=="TeacherEnrollment"&&b!=="TaEnrollment"?this.$privileges.hide():this.$privileges.show()},i.prototype.changeEnrollment=function(a){return this.model.set("enrollment_type",a.target.value)},i.prototype.openAgain=function(){return this.startOverFrd(),i.__super__.openAgain.apply(this,arguments)},i.prototype.hasUsers=function(){var a;return(a=this.model.get("users"))!=null?a.length:void 0},i.prototype.onSaveSuccess=function(){var a,b,c;this.model.incrementStep();if(this.model.get("step")===3)return b=this.rolesCollection.where({name:this.model.get("enrollment_type")})[0],b!=null&&b.increment("count",this.model.get("users").length),a=this.model.get("users").length,(c=this.courseModel)!=null?c.increment("pendingInvitationsCount",a):void 0},i.prototype.validateBeforeSave=function(a){return this.model.get("step")===1&&!a.user_list?{user_list:[{type:"required",message:e.t("required","Please enter some email addresses")}]}:{}},i.prototype.startOver=function(){return this.model.startOver()},i.prototype.startOverFrd=function(){var a;return this.model.startOver(),(a=this.$textarea)!=null?a.val(""):void 0},i.prototype.afterRender=function(){return this.$("[placeholder]").placeholder(),this.maybeShowPrivileges()},i}(f)})}).call(this)