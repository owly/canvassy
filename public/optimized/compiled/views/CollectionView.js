(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define(["jquery","Backbone","jst/collectionView"],function(b,d,e){var f,g;return f=function(d){function f(){return this.renderItem=a(this.renderItem,this),this.rerenderUnlessCollection=a(this.rerenderUnlessCollection,this),this.renderOnAdd=a(this.renderOnAdd,this),this.removeItem=a(this.removeItem,this),this.renderOnReset=a(this.renderOnReset,this),this.removePreviousItems=a(this.removePreviousItems,this),this.render=a(this.render,this),g=f.__super__.constructor.apply(this,arguments),g}return c(f,d),f.optionProperty("itemView"),f.optionProperty("itemViewOptions"),f.prototype.className="collectionView",f.prototype.els={".collectionViewItems":"$list"},f.prototype.defaults={itemViewOptions:{}},f.prototype.template=e,f.prototype.initialize=function(a){return f.__super__.initialize.apply(this,arguments),this.attachCollection()},f.prototype.render=function(){return f.__super__.render.apply(this,arguments),this.collection.length&&this.renderItems(),this},f.prototype.toJSON=function(){return this.options},f.prototype.attachCollection=function(){return this.collection.on("reset",this.renderOnReset),this.collection.on("add",this.renderOnAdd),this.collection.on("remove",this.removeItem),this.collection.on("remove",this.rerenderUnlessCollection)},f.prototype.removePreviousItems=function(a){var b=this;return this.$list.children().each(function(a,c){var d;return(d=b.$(c).data("view"))!=null?d.remove():void 0})},f.prototype.renderOnReset=function(){return this.removePreviousItems(),this.render()},f.prototype.renderItems=function(){return this.collection.each(this.renderItem)},f.prototype.removeItem=function(a){return a.view.remove()},f.prototype.renderOnAdd=function(a){return this.collection.length===1?this.render():this.renderItem(a)},f.prototype.rerenderUnlessCollection=function(){if(!this.collection.length)return this.render()},f.prototype.renderItem=function(a){var c;return c=new this.itemView(b.extend({},this.itemViewOptions||{},{model:a})),c.render(),this.insertView(c)},f.prototype.insertView=function(a){var b;return b=this.collection.indexOf(a.model),b===0?this.prependView(a):b===this.collection.length-1?this.appendView(a):this.insertViewAtIndex(a,b)},f.prototype.insertViewAtIndex=function(a,b){var c;return c=this.$list.children().eq(b),c.length?c.before(a.el):this.$list.append(a.el)},f.prototype.prependView=function(a){return this.$list.prepend(a.el)},f.prototype.appendView=function(a){return this.$list.append(a.el)},f}(d.View)})}).call(this)