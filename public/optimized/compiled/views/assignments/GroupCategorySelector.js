(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define(["i18n!assignment","Backbone","underscore","jquery","jst/assignments/GroupCategorySelector","compiled/jquery/toggleAccessibly"],function(b,d,e,f,g,h){var i,j;return i=function(d){function k(){return this._validateGroupCategoryID=a(this._validateGroupCategoryID,this),this.validateBeforeSave=a(this.validateBeforeSave,this),this.filterFormData=a(this.filterFormData,this),this.toJSON=a(this.toJSON,this),this.toggleGroupCategoryOptions=a(this.toggleGroupCategoryOptions,this),this.showGroupCategoryCreateDialog=a(this.showGroupCategoryCreateDialog,this),j=k.__super__.constructor.apply(this,arguments),j}var e,h,i;return c(k,d),k.prototype.template=g,e="#assignment_group_category_id",i="#assignment_has_group_category",h="#group_category_options",k.prototype.els=function(){var a;return a={},a[""+e]="$groupCategoryID",a[""+i]="$hasGroupCategory",a[""+h]="$groupCategoryOptions",a}(),k.prototype.events=function(){var a;return a={},a["change "+e]="showGroupCategoryCreateDialog",a["change "+i]="toggleGroupCategoryOptions",a}(),k.optionProperty("parentModel"),k.optionProperty("groupCategories"),k.optionProperty("nested"),k.prototype.showGroupCategoryCreateDialog=function(){var a=this;if(this.$groupCategoryID.val()==="new")return window.addGroupCategory(function(b){var c,d;return d=b[0].group_category,c=f("<option>"),c.val(d.id),c.text(d.name),a.$groupCategoryID.prepend(c),a.$groupCategoryID.val(d.id),a.groupCategories.push(d)})},k.prototype.toggleGroupCategoryOptions=function(){this.$groupCategoryOptions.toggleAccessibly(this.$hasGroupCategory.prop("checked"));if(this.$hasGroupCategory.prop("checked")&&this.groupCategories.length===0)return this.showGroupCategoryCreateDialog()},k.prototype.toJSON=function(){return{groupCategoryId:this.parentModel.groupCategoryId(),groupCategories:this.groupCategories,gradeGroupStudentsIndividually:this.parentModel.gradeGroupStudentsIndividually(),frozenAttributes:this.parentModel.frozenAttributes(),nested:this.nested}},k.prototype.filterFormData=function(a){var b;return b=a.has_group_category,delete a.has_group_category,b||(a.group_category_id=null,a.grade_group_students_individually=!1),a},k.prototype.fieldSelectors={groupCategorySelector:"#assignment_group_category_id"},k.prototype.validateBeforeSave=function(a,b){return b=this._validateGroupCategoryID(a,b),b},k.prototype._validateGroupCategoryID=function(a,c){var d;return d=this.nested?a.assignment.groupCategoryId():a.group_category_id,d==="new"&&(c.groupCategorySelector=[{message:b.t("group_assignment_must_have_group_set","Please select a group set for this assignment")}]),c},k}(d.View)})}).call(this)