(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define(["i18n!overrides","Backbone","underscore","jst/assignments/DueDateView","jquery","jquery.toJSON","jquery.instructure_date_and_time","jquery.instructure_forms"],function(d,e,f,g,h){var i,j;return i=function(e){function i(){return this.updateOverride=a(this.updateOverride,this),this.validateBeforeSave=a(this.validateBeforeSave,this),this.getFormValues=a(this.getFormValues,this),this.reRenderSections=a(this.reRenderSections,this),this.showRemoveButton=a(this.showRemoveButton,this),this.hideRemoveButton=a(this.hideRemoveButton,this),this.removeDueDate=a(this.removeDueDate,this),this.afterRender=a(this.afterRender,this),j=i.__super__.constructor.apply(this,arguments),j}return c(i,e),i.prototype.template=g,i.prototype.tagName="li",i.prototype.className="due-date-row",i.prototype.events={"click .remove-link":"removeDueDate"},i.prototype.afterRender=function(){return this.$el.find(".date_field").datetime_field()},i.prototype.removeDueDate=function(a){return a.preventDefault(),this.trigger("remove",this.model),this.remove()},i.prototype.hideRemoveButton=function(){return this.$el.find(".remove-link").hide()},i.prototype.showRemoveButton=function(){return this.$el.find(".remove-link").show()},i.prototype.reRenderSections=function(a){return f.each(this.options.views,function(b){return b.sections=a,b.render()})},i.prototype.getFormValues=function(){var a,c,d,e,f,g,i,j,k;e=this.$el.find("form").toJSON(),j=["due_at","lock_at","unlock_at"];for(g=0,i=j.length;g<i;g++)a=j[g],e[a]=h.unfudgeDateForProfileTimezone(e[a]);e.course_section_id=parseInt(e.course_section_id,10),d=this.validateBeforeSave(e,{}),this.$el.hideErrors(),k=d.assignmentOverrides;for(c in k){if(!b.call(k,c))continue;f=k[c],this.$("[name="+c+"]").errorBox(f)}return e},i.prototype.validateBeforeSave=function(a,b){var c,e,g,h;return e={},a&&(g=a.lock_at,h=a.unlock_at,c=a.due_at,g&&c&&g<c&&(e.lock_at=d.t("lock_date_before_due_date","Lock date cannot be before due date")),h&&c&&h>c?e.unlock_at=d.t("unlock_date_after_due_date","Unlock date cannot be after due date"):h&&g&&h>g&&(e.unlock_at=d.t("unlock_date_after_lock_date","Unlock date cannot be after lock date"))),f.keys(e).length>0&&(b.assignmentOverrides=e),b},i.prototype.updateOverride=function(){return this.model.set(this.getFormValues())},i}(e.View)})}).call(this)