(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define(["underscore","Backbone","compiled/views/collaborations/CollaborationView","compiled/views/collaborations/CollaborationFormView"],function(b,d,e,f){var g,h,i,j,k;return i=b.each,j=b.reject,h=d.View,g=function(b){function d(){return this.onFormError=a(this.onFormError,this),this.onFormHide=a(this.onFormHide,this),this.onCollaborationDelete=a(this.onCollaborationDelete,this),this.initPageState=a(this.initPageState,this),k=d.__super__.constructor.apply(this,arguments),k}return c(d,b),d.prototype.events={"click .add_collaboration_link":"addCollaboration"},d.prototype.initialize=function(){return this.cacheElements(),this.createViews(),this.attachEvents(),$(document).on("ready",this.initPageState)},d.prototype.initPageState=function(){if($("#collaborations .collaboration:visible").length===0)return this.addFormView.render(!1),this.$addLink.hide()},d.prototype.cacheElements=function(){return this.$header=$("h1:first"),this.$addLink=$(".add_collaboration_link"),this.$addForm=$("#new_collaboration"),this.$noCollaborationsMessage=$("#no_collaborations_message")},d.prototype.createViews=function(){return this.addFormView=new f({el:this.$addForm}),this.collaborationViews=$("div.collaboration").map(function(){return new e({el:$(this)})})},d.prototype.attachEvents=function(){var a=this;return this.addFormView.on("hide",this.onFormHide).on("error",this.onFormError),i(this.collaborationViews,function(b){return b.on("delete",a.onCollaborationDelete)})},d.prototype.addCollaboration=function(a){return a.preventDefault(),this.$addLink.hide(),this.addFormView.render(),this.$el.scrollTo(this.addFormView.$el)},d.prototype.onCollaborationDelete=function(a){this.collaborationViews=j(this.collaborationViews,function(b){return b===a});if(this.collaborationViews.length===0)return this.$noCollaborationsMessage.show(),this.addFormView.render(!1)},d.prototype.onFormHide=function(){return this.$addLink.show(),this.$header.focus()},d.prototype.onFormError=function(a,b){return a.focus().errorBox(b)},d}(h)})}).call(this)