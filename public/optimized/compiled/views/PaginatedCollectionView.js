(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define(["jquery","underscore","compiled/views/CollectionView","jst/paginatedCollection"],function(b,d,e,f){var g,h;return g=function(g){function i(){return this.showLoadingIndicator=a(this.showLoadingIndicator,this),this.hideLoadingIndicator=a(this.hideLoadingIndicator,this),this.checkScroll=a(this.checkScroll,this),this.detachScroll=a(this.detachScroll,this),this.attachScroll=a(this.attachScroll,this),h=i.__super__.constructor.apply(this,arguments),h}return c(i,g),i.prototype.defaults={buffer:500,scrollContainer:window},i.prototype.els=d.extend({},e.prototype.els,{".paginatedLoadingIndicator":"$loadingIndicator"}),i.optionProperty("scrollContainer"),i.prototype.template=f,i.prototype.initialize=function(){return i.__super__.initialize.apply(this,arguments),this.initScrollContainer()},i.prototype.attachCollection=function(){return i.__super__.attachCollection.apply(this,arguments),this.collection.on("reset",this.attachScroll),this.collection.on("fetched:last",this.detachScroll),this.collection.on("beforeFetch",this.showLoadingIndicator),this.collection.on("fetch",this.hideLoadingIndicator)},i.prototype.initScrollContainer=function(){return this.scrollContainer=b(this.scrollContainer),this.heightContainer=this.scrollContainer[0]===window?document.body:this.scrollContainer[0]},i.prototype.attachScroll=function(){var a,b;return b="scroll.pagination:"+this.cid,a="resize.pagination:"+this.cid,this.scrollContainer.on(b,this.checkScroll),this.scrollContainer.on(a,this.checkScroll)},i.prototype.detachScroll=function(){return this.scrollContainer.off(".pagination:"+this.cid)},i.prototype.checkScroll=function(){var a;if(this.fetchingPage)return;a=this.heightContainer.scrollHeight-this.scrollContainer.scrollTop()-this.scrollContainer.height();if(a<this.options.buffer)return this.collection.fetch({page:"next"})},i.prototype.remove=function(){return this.detachScroll(),i.__super__.remove.apply(this,arguments)},i.prototype.afterRender=function(){return i.__super__.afterRender.apply(this,arguments),this.hideLoadingIndicator()},i.prototype.hideLoadingIndicator=function(){var a;return(a=this.$loadingIndicator)!=null?a.hide():void 0},i.prototype.showLoadingIndicator=function(){var a;return(a=this.$loadingIndicator)!=null?a.show():void 0},i}(e)})}).call(this)