(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define(["Backbone","jquery","jst/quizzes/fileUploadQuestionState","jst/quizzes/fileUploadedOrRemoved","underscore","jquery.instructure_forms","jquery.disableWhileLoading"],function(b,d,e,f,g){var h,i,j;return i=b.View,h=function(b){function h(){return this.deleteAttachment=a(this.deleteAttachment,this),this.processAttachment=a(this.processAttachment,this),this.removeFileStatusMessage=a(this.removeFileStatusMessage,this),this.render=a(this.render,this),this.openFileBrowser=a(this.openFileBrowser,this),this.checkForFileChange=a(this.checkForFileChange,this),j=h.__super__.constructor.apply(this,arguments),j}return c(h,b),h.prototype.els={".file-upload":"$fileUpload",".file-upload-btn":"$fileDialogButton",".attachment-id":"$attachmentID",".file-upload-box":"$fileUploadBox"},h.prototype.events={"change input[type=file]":"checkForFileChange","click .file-upload-btn":"openFileBrowser","click .delete-attachment":"deleteAttachment"},h.prototype.checkForFileChange=function(a){var b,c;a.preventDefault(),a.stopPropagation();if(c=this.$fileUpload.val())return this.removeFileStatusMessage(),this.model.set("file",this.$fileUpload[0]),b=this.model.save(null,{success:this.processAttachment}),this.$fileUploadBox.disableWhileLoading(b)},h.prototype.openFileBrowser=function(a){return a.preventDefault(),this.$fileUpload.click()},h.prototype.render=function(){var a;return h.__super__.render.apply(this,arguments),a=!!d.browser.msie,a&&this.$fileUpload.remove(),this.$fileUploadBox.html(e(g.extend({},this.model.present(),{isIE:a}))),this},h.prototype.removeFileStatusMessage=function(){return this.$fileUploadBox.siblings(".file-status").remove()},h.prototype.processAttachment=function(a){return this.$attachmentID.val(this.model.id).trigger("change"),this.$fileUploadBox.addClass("file-upload-box-with-file"),this.render(),this.$fileUploadBox.parent().append(f(g.extend({},this.model.present(),{fileUploaded:!0})))},h.prototype.deleteAttachment=function(a){var b;return a.preventDefault(),this.$attachmentID.val("").trigger("change"),this.$fileUploadBox.removeClass("file-upload-box-with-file"),b=this.model.present(),this.model.clear(),this.removeFileStatusMessage(),this.render(),this.$fileUploadBox.parent().append(f(b))},h}(i)})}).call(this)