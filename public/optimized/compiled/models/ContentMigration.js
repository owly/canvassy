(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define(["underscore","jquery","Backbone","jquery.instructure_forms"],function(b,d,e){var f,g;return f=function(f){function h(){return this.addDaySubsitutions=a(this.addDaySubsitutions,this),this.save=a(this.save,this),this.urlRoot=a(this.urlRoot,this),g=h.__super__.constructor.apply(this,arguments),g}return c(h,f),h.prototype.urlRoot=function(){return"/api/v1/courses/"+this.get("course_id")+"/content_migrations"},h.dynamicDefaults={},h.prototype.initialize=function(a){return h.__super__.initialize.apply(this,arguments),this.dynamicDefaults=a},h.prototype.resetModel=function(){return this.clear(),this.resetDynamicDefaultCollections(),this.set(this.dynamicDefaults)},h.prototype.resetDynamicDefaultCollections=function(){return b.each(this.dynamicDefaults,function(a,c,d){var f,g;if(a instanceof e.Collection)return f=a,g=f.map(function(a){return a}),b.each(g,function(a){return f.remove(a)})})},h.prototype.save=function(){var a,b,c=this;return this.get("pre_attachment")?(a=d.Deferred(),b=this.get("pre_attachment").fileElement,delete this.get("pre_attachment").fileElement,h.__super__.save.call(this,null,{error:function(b){return a.rejectWith(c,b.responseText)},success:function(d,f,g){var h;return h=new e.Model(c.get("pre_attachment").upload_params),h.url=function(){return c.get("pre_attachment").upload_url},h.set("attachment",b),h.save(null,{multipart:b,success:function(b,d){return d.message?a.rejectWith(c,d.message):c.fetch({success:function(){return a.resolve()}})},error:function(b){return a.rejectWith(c,b)}})}}),a):h.__super__.save.apply(this,arguments)},h.prototype.toJSON=function(){var a;return a=h.__super__.toJSON.apply(this,arguments),this.addDaySubsitutions(a),a},h.prototype.addDaySubsitutions=function(a){var b;b=this.get("daySubCollection"),a.date_shift_options||(a.date_shift_options={});if(b)return a.date_shift_options.day_substitutions=b.toJSON()},h.prototype.setDateShiftOptions=function(a){var b,c,d,e;return e=a.value,c=a.property,d=a.silent,b=this.get("date_shift_options")||{},b[c]=e,this.set("date_shift_options",b,{silent:d})},h}(e.Model)})}).call(this)