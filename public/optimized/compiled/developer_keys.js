(function(){define(["i18n!developer_keys","jquery","jst/developer_key","jst/developer_key_form","compiled/fn/preventDefault","jquery.ajaxJSON","jquery.instructure_date_and_time","jqueryui/dialog"],function(a,b,c,d,e){var f,g,h,i;return i=0,g=function(d){var e;return d.icon_image_url=d.icon_url||"/images/blank.png",d.name||(d.name=a.t("unnamed_tool","Unnamed Tool")),d.user_name||(d.user_name=a.t("no_user","No User")),d.created=b.parseFromISO(d.created_at).datetime_formatted,d.last_auth=b.parseFromISO(d.last_auth_at).datetime_formatted,d.last_access=b.parseFromISO(d.last_access_at).datetime_formatted,e=b(c(d)),e.data("key",d)},f=function(c,e){var f;return f=b(d(c||{})),f.formSubmit({beforeSubmit:function(){return b("#edit_dialog button.submit").text(a.t("button.saving","Saving Key..."))},disableWhileLoading:!0,success:function(a){var c;return b("#edit_dialog").dialog("close"),c=g(a),e?e.after(c).remove():b("#keys tbody").prepend(c)},error:function(){return b("#edit_dialog button.submit").text(a.t("button.saving_failed","Saving Key Failed"))}}),f},h=function(){var a;return b("#loading").attr("class","loading"),i++,a=b.ajaxJSON("/api/v1/developer_keys?page="+i,"GET",{},function(c){var d,e,f,j;for(f=0,j=c.length;f<j;f++)e=c[f],d=g(e),b("#keys tbody").append(d);return a.getAllResponseHeaders().match(/rel="next"/)?i>1?h():b("#loading").attr("class","show_more"):b("#loading").attr("class","")})},h(),b("#keys").on("click",".delete_link",e(function(){var c,d;return c=b(this).closest(".key"),d=c.data("key"),c.confirmDelete({url:"/api/v1/developer_keys/"+d.id,message:a.t("messages.confirm_delete","Are you sure you want to delete this developer key?"),success:function(){return c.remove()}})})).on("click",".edit_link",e(function(){var a,c,d;return c=b(this).closest(".key"),d=c.data("key"),a=f(d,c),b("#edit_dialog").empty().append(a).dialog("open")})),b(".add_key").click(function(a){var c;return a.preventDefault(),c=f(),b("#edit_dialog").empty().append(c).dialog("open")}),b("#edit_dialog").html(d({})).dialog({autoOpen:!1,width:350}).on("click",".cancel",function(){return b("#edit_dialog").dialog("close")}),b(".show_all").click(function(a){return h()})})}).call(this)