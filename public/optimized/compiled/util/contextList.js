(function(){define(["underscore","str/htmlEscape","compiled/util/listWithOthers","jquery.instructure_misc_helpers"],function(a,b,c){var d,e,f;return f=function(b,c){return b=a.clone(b),b.activeFilter=a.include(c,""+b.type+"_"+b.id),b.sortBy=""+(b.activeFilter?0:1)+"_"+b.name.toLowerCase(),b},e=function(a,c){var d;return d=b(a.name),a.activeFilter&&(d="<span class='active-filter'>"+d+"</span>"),c&&a.type==="course"&&(d="<a href='"+b(a.url)+"'>"+d+"</a>"),$.raw(d)},d=function(b,d,g){var h,i,j,k,l;g==null&&(g={}),i=(l=g.filters)!=null?l:[],h=[];for(k in b)j=b[k],h=h.concat(a.values(a.pick(d[k],j)));return h=a.chain(h).map(function(a){return f(a,i)}).sortBy("sortBy").map(function(a){return e(a,g.linkToContexts)}).value(),g.hardCutoff&&(h=h.slice(0,g.hardCutoff)),c(h)}})}).call(this)