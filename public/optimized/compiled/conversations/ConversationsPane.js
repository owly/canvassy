(function(){define(["i18n!conversations.conversations_pane","compiled/conversations/ConversationsList","str/htmlEscape","compiled/util/shortcut","compiled/jquery/offsetFrom"],function(a,b,c,d){return function(){function c(a,c){this.app=a,this.$pane=c,this.list=new b(this,this.$pane.find("> div.conversations")),this.selected=[],this.initializeActions()}return d(c,"list","baseData","updateItems","isActive"),c.prototype.initializeActions=function(){var b=this;return $("#menu-wrapper").on("click","a.action_delete_all",function(c){c.preventDefault();if(confirm(a.t("confirm.delete_conversation","Are you sure you want to delete your copy of this conversation? This action cannot be undone.")))return b.action($(c.currentTarget),{method:"DELETE"})})},c.prototype.updateView=function(a){return this.list.load(a)},c.prototype.action=function(a,b){var c,d,e,f=this;return d=b.conversationId||a.closest("div.conversations li").data("id")||a.parents("ul[data-id]:first").data("id"),c=this.list.item(d),b=$.extend(!0,{},{url:this.actionUrlFor(a,d)},b),e=b.success,b.success=function(a){var b;return((b=a.messages)!=null?b.length:void 0)&&f.app.addMessage(a.messages[0]),typeof e=="function"?e(a):void 0},c.inboxAction(b)},c.prototype.actionUrlFor=function(a,b){var c;return c=$.replaceTags(a.attr("href"),"id",b),c+(c.match(/\?/)?"&":"?")+$.param(this.baseData())},c.prototype.active=function(){return this.list.active},c.prototype.filterMenu=function(a){var b,c,d,e,f,g,h;b=$(a.currentTarget).parents("li:first"),c=$(a.currentTarget).siblings("ul:first"),c.find("li").show(),f=b.hasClass("read"),g=b.hasClass("starred"),e=b.hasClass("private"),h=!b.hasClass("unsubscribed"),d=b.hasClass("archived"),f&&c.find(".action_mark_as_read").parent().remove(),f||c.find(".action_mark_as_unread").parent().remove(),g&&c.find(".action_star").parent().remove(),g||c.find(".action_unstar").parent().remove(),d&&c.find(".action_archive").parent().remove(),d||c.find(".action_unarchive").parent().remove(),d&&(c.find(".action_mark_as_read").parent().remove(),c.find(".action_mark_as_unread").parent().remove());if(e)return c.find(".action_subscribe, .action_unsubscribe").parent().remove();h&&c.find(".action_subscribe").parent().remove();if(!h)return c.find(".action_unsubscribe").parent().remove()},c.prototype.resize=function(a){return this.list.$scroller.height(a-$("#actions").outerHeight(!0)),this.list.fetchVisible()},c}()})}).call(this)