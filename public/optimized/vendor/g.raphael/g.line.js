/*!
 * g.Raphael 0.5 - Charting library, based on RaphaÃ«l
 *
 * Copyright (c) 2009 Dmitry Baranovskiy (http://g.raphaeljs.com)
 * Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
 */
(function(){function a(a,b){var c=a.length/b,d=0,e=c,f=0,g=[];while(d<a.length)e--,e<0?(f+=a[d]*(1+e),g.push(f/c),f=a[d++]*-e,e+=c):f+=a[d++];return g}function b(a,b,c,d,e,f){var g=(c-a)/2,h=(e-c)/2,i=Math.atan((c-a)/Math.abs(d-b)),j=Math.atan((e-c)/Math.abs(d-f));i=b<d?Math.PI-i:i,j=f<d?Math.PI-j:j;var k=Math.PI/2-(i+j)%(Math.PI*2)/2,l=g*Math.sin(k+i),m=g*Math.cos(k+i),n=h*Math.sin(k+j),o=h*Math.cos(k+j);return{x1:c-l,y1:d+m,x2:c+n,y2:d+o}}function c(c,d,e,f,g,h,i,j){function W(a){var b=[];for(var j=0,k=h.length;j<k;j++)b=b.concat(h[j]);b.sort();var m=[],n=[];for(j=0,k=b.length;j<k;j++)b[j]!=b[j-1]&&m.push(b[j])&&n.push(d+l+(b[j]-z)*E);b=m,k=b.length;var o=a||c.set();for(j=0;j<k;j++){var q=n[j]-(n[j]-(n[j-1]||d))/2,s=((n[j+1]||d+f)-n[j])/2+(n[j]-(n[j-1]||d))/2,t;a?t={}:o.push(t=c.rect(q-1,e,Math.max(s+1,1),g).attr({stroke:"none",fill:"#000",opacity:0})),t.values=[],t.symbols=c.set(),t.y=[],t.x=n[j],t.axis=b[j];for(var u=0,v=i.length;u<v;u++){m=h[u]||h[0];for(var w=0,x=m.length;w<x;w++)m[w]==b[j]&&(t.values.push(i[u][w]),t.y.push(e+g-l-(i[u][w]-C)*F),t.symbols.push(r.symbols[u][w]))}a&&a.call(t)}!a&&(p=o)}function X(a){var b=a||c.set(),f;for(var j=0,k=i.length;j<k;j++)for(var m=0,n=i[j].length;m<n;m++){var o=d+l+((h[j]||h[0])[m]-z)*E,p=d+l+((h[j]||h[0])[m?m-1:1]-z)*E,s=e+g-l-(i[j][m]-C)*F;a?f={}:b.push(f=c.circle(o,s,Math.abs(p-o)/2).attr({stroke:"none",fill:"#000",opacity:0})),f.x=o,f.y=s,f.value=i[j][m],f.line=r.lines[j],f.shade=r.shades[j],f.symbol=r.symbols[j][m],f.symbols=r.symbols[j],f.axis=(h[j]||h[0])[m],a&&a.call(f)}!a&&(q=b)}var k=this;j=j||{},c.raphael.is(h[0],"array")||(h=[h]),c.raphael.is(i[0],"array")||(i=[i]);var l=j.gutter||10,m=Math.max(h[0].length,i[0].length),n=j.symbol||"",o=j.colors||k.colors,p=null,q=null,r=c.set(),s=[];for(var t=0,u=i.length;t<u;t++)m=Math.max(m,i[t].length);var v=c.set();for(t=0,u=i.length;t<u;t++)j.shade&&v.push(c.path().attr({stroke:"none",fill:o[t],opacity:j.nostroke?1:.3})),i[t].length>f-2*l&&(i[t]=a(i[t],f-2*l),m=f-2*l),h[t]&&h[t].length>f-2*l&&(h[t]=a(h[t],f-2*l));var w=Array.prototype.concat.apply([],h),x=Array.prototype.concat.apply([],i),y=k.snapEnds(Math.min.apply(Math,w),Math.max.apply(Math,w),h[0].length-1),z=y.from,A=y.to,B=k.snapEnds(Math.min.apply(Math,x),Math.max.apply(Math,x),i[0].length-1),C=B.from,D=B.to,E=(f-l*2)/(A-z||1),F=(g-l*2)/(D-C||1),G=c.set();if(j.axis){var H=(j.axis+"").split(/[,\s]+/);+H[0]&&G.push(k.axis(d+l,e+l,f-2*l,z,A,j.axisxstep||Math.floor((f-2*l)/20),2,c)),+H[1]&&G.push(k.axis(d+f-l,e+g-l,g-2*l,C,D,j.axisystep||Math.floor((g-2*l)/20),3,c)),+H[2]&&G.push(k.axis(d+l,e+g-l,f-2*l,z,A,j.axisxstep||Math.floor((f-2*l)/20),0,c)),+H[3]&&G.push(k.axis(d+l,e+g-l,g-2*l,C,D,j.axisystep||Math.floor((g-2*l)/20),1,c))}var I=c.set(),J=c.set(),K;for(t=0,u=i.length;t<u;t++){j.nostroke||I.push(K=c.path().attr({stroke:o[t],"stroke-width":j.width||2,"stroke-linejoin":"round","stroke-linecap":"round","stroke-dasharray":j.dash||""}));var L=Raphael.is(n,"array")?n[t]:n,M=c.set();s=[];for(var N=0,O=i[t].length;N<O;N++){var P=d+l+((h[t]||h[0])[N]-z)*E,Q=e+g-l-(i[t][N]-C)*F;(Raphael.is(L,"array")?L[N]:L)&&M.push(c[Raphael.is(L,"array")?L[N]:L](P,Q,(j.width||2)*3).attr({fill:o[t],stroke:"none"}));if(j.smooth){if(N&&N!=O-1){var R=d+l+((h[t]||h[0])[N-1]-z)*E,S=e+g-l-(i[t][N-1]-C)*F,T=d+l+((h[t]||h[0])[N+1]-z)*E,U=e+g-l-(i[t][N+1]-C)*F,V=b(R,S,P,Q,T,U);s=s.concat([V.x1,V.y1,P,Q,V.x2,V.y2])}N||(s=["M",P,Q,"C",P,Q])}else s=s.concat([N?"L":"M",P,Q])}j.smooth&&(s=s.concat([P,Q,P,Q])),J.push(M),j.shade&&v[t].attr({path:s.concat(["L",P,e+g-l,"L",d+l+((h[t]||h[0])[0]-z)*E,e+g-l,"z"]).join(",")}),!j.nostroke&&K.attr({path:s.join(",")})}return r.push(I,v,J,G,p,q),r.lines=I,r.shades=v,r.symbols=J,r.axis=G,r.hoverColumn=function(a,b){return!p&&W(),p.mouseover(a).mouseout(b),this},r.clickColumn=function(a){return!p&&W(),p.click(a),this},r.hrefColumn=function(a){var b=c.raphael.is(arguments[0],"array")?arguments[0]:arguments;if(!(arguments.length-1)&&typeof a=="object")for(var d in a)for(var e=0,f=p.length;e<f;e++)p[e].axis==d&&p[e].attr("href",a[d]);!p&&W();for(e=0,f=b.length;e<f;e++)p[e]&&p[e].attr("href",b[e]);return this},r.hover=function(a,b){return!q&&X(),q.mouseover(a).mouseout(b),this},r.click=function(a){return!q&&X(),q.click(a),this},r.each=function(a){return X(a),this},r.eachColumn=function(a){return W(a),this},r}var d=function(){};d.prototype=Raphael.g,c.prototype=new d,Raphael.fn.linechart=function(a,b,d,e,f,g,h){return new c(this,a,b,d,e,f,g,h)}})()